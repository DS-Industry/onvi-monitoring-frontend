import{r as s,d as ye,e as Ce,q as Se,v as P,w as be,ah as Ue,cg as _e,f as Je,a2 as Qe,y as Fe,z as Y,ch as Xe,ci as et,cj as tt,j as e,F as at,aB as we,aC as ke,L as Z,K as O,Q as st,B as ee,M as nt,ck as rt,ap as ve,aq as We}from"./index-C24s9YLx.js";const De=l=>s.createElement("svg",{width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...l},s.createElement("rect",{width:16,height:16,fill:"#F5F5F5"}),s.createElement("g",{clipPath:"url(#clip0_751_38745)"},s.createElement("rect",{width:1440,height:812,transform:"translate(-644 -702)",fill:"white"}),s.createElement("circle",{cx:8,cy:8,r:8,fill:"#EB5757"})),s.createElement("defs",null,s.createElement("clipPath",{id:"clip0_751_38745"},s.createElement("rect",{width:1440,height:812,fill:"white",transform:"translate(-644 -702)"})))),Ne=l=>s.createElement("svg",{width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...l},s.createElement("rect",{width:16,height:16,fill:"#F5F5F5"}),s.createElement("g",{clipPath:"url(#clip0_751_38745)"},s.createElement("rect",{width:1440,height:812,transform:"translate(-821 -702)",fill:"white"}),s.createElement("circle",{cx:8,cy:8,r:8,fill:"#F58A00"})),s.createElement("defs",null,s.createElement("clipPath",{id:"clip0_751_38745"},s.createElement("rect",{width:1440,height:812,fill:"white",transform:"translate(-821 -702)"})))),Te=l=>s.createElement("svg",{width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...l},s.createElement("rect",{width:16,height:16,fill:"#F5F5F5"}),s.createElement("g",{clipPath:"url(#clip0_751_38745)"},s.createElement("rect",{width:1440,height:812,transform:"translate(-1051 -702)",fill:"white"}),s.createElement("circle",{cx:8,cy:8,r:8,fill:"#00A355"})),s.createElement("defs",null,s.createElement("clipPath",{id:"clip0_751_38745"},s.createElement("rect",{width:1440,height:812,fill:"white",transform:"translate(-1051 -702)"})))),je=l=>s.createElement("svg",{width:17,height:12,viewBox:"0 0 17 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",...l},s.createElement("rect",{width:17,height:12,fill:"#F5F5F5"}),s.createElement("g",{clipPath:"url(#clip0_751_38745)"},s.createElement("rect",{width:1440,height:812,transform:"translate(-927 -745)",fill:"white"}),s.createElement("path",{d:"M0.328 11V0.535999H7.144V2.104H2.184V4.776H3.896C4.64267 4.776 5.30933 4.872 5.896 5.064C6.49333 5.256 6.96267 5.57067 7.304 6.008C7.656 6.43467 7.832 7.016 7.832 7.752C7.832 8.50933 7.66667 9.128 7.336 9.608C7.00533 10.088 6.54667 10.44 5.96 10.664C5.384 10.888 4.71733 11 3.96 11H0.328ZM2.184 9.56H3.736C5.25067 9.56 6.008 8.968 6.008 7.784C6.008 7.19733 5.81067 6.78133 5.416 6.536C5.032 6.29067 4.46133 6.168 3.704 6.168H2.184V9.56ZM9.3975 11.192C9.08817 11.192 8.81083 11.1387 8.5655 11.032L8.8855 9.368C8.93883 9.37867 8.9975 9.39467 9.0615 9.416C9.1255 9.42667 9.19483 9.432 9.2695 9.432C9.51483 9.432 9.7175 9.32 9.8775 9.096C10.0375 8.872 10.1495 8.51467 10.2135 8.024C10.3202 7.20267 10.4162 6.38667 10.5015 5.576C10.5975 4.76533 10.6882 3.95467 10.7735 3.144H16.1015V11H14.2615V4.6H12.2455C12.1708 5.25067 12.0908 5.90667 12.0055 6.568C11.9308 7.21867 11.8508 7.86933 11.7655 8.52C11.6482 9.39467 11.3922 10.0613 10.9975 10.52C10.6028 10.968 10.0695 11.192 9.3975 11.192Z",fill:"black"})),s.createElement("defs",null,s.createElement("clipPath",{id:"clip0_751_38745"},s.createElement("rect",{width:1440,height:812,fill:"white",transform:"translate(-927 -745)"})))),Ie=l=>s.createElement("svg",{width:29,height:12,viewBox:"0 0 29 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",...l},s.createElement("rect",{width:29,height:12,fill:"#F5F5F5"}),s.createElement("g",{clipPath:"url(#clip0_751_38745)"},s.createElement("rect",{width:1440,height:812,transform:"translate(-1074 -745)",fill:"white"}),s.createElement("path",{d:"M5.392 11.192C4.48533 11.192 3.68533 10.9733 2.992 10.536C2.29867 10.088 1.75467 9.45867 1.36 8.648C0.976 7.82667 0.784 6.85067 0.784 5.72C0.784 4.58933 0.976 3.624 1.36 2.824C1.75467 2.024 2.29867 1.41067 2.992 0.983999C3.68533 0.557333 4.48533 0.344 5.392 0.344C6.30933 0.344 7.11467 0.557333 7.808 0.983999C8.50133 1.41067 9.04 2.024 9.424 2.824C9.81867 3.624 10.016 4.58933 10.016 5.72C10.016 6.85067 9.81867 7.82667 9.424 8.648C9.04 9.45867 8.50133 10.088 7.808 10.536C7.11467 10.9733 6.30933 11.192 5.392 11.192ZM5.392 9.576C6.21333 9.576 6.86933 9.22933 7.36 8.536C7.85067 7.832 8.096 6.89333 8.096 5.72C8.096 4.54667 7.85067 3.62933 7.36 2.968C6.86933 2.296 6.21333 1.96 5.392 1.96C4.57067 1.96 3.91467 2.296 3.424 2.968C2.93333 3.62933 2.688 4.54667 2.688 5.72C2.688 6.89333 2.93333 7.832 3.424 8.536C3.91467 9.22933 4.57067 9.576 5.392 9.576ZM13.7994 11V2.104H10.7754V0.535999H18.6794V2.104H15.6554V11H13.7994ZM20.4218 11V0.535999H28.2298V11H26.3738V2.104H22.2778V11H20.4218Z",fill:"black"})),s.createElement("defs",null,s.createElement("clipPath",{id:"clip0_751_38745"},s.createElement("rect",{width:1440,height:812,fill:"white",transform:"translate(-1074 -745)"})))),Ee=l=>s.createElement("svg",{width:11,height:12,viewBox:"0 0 11 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",...l},s.createElement("rect",{width:11,height:12,fill:"#F5F5F5"}),s.createElement("g",{clipPath:"url(#clip0_751_38745)"},s.createElement("rect",{width:1440,height:812,transform:"translate(-1203 -745)",fill:"white"}),s.createElement("path",{d:"M5.392 11.192C4.48533 11.192 3.68533 10.9733 2.992 10.536C2.29867 10.088 1.75467 9.45867 1.36 8.648C0.976 7.82667 0.784 6.85067 0.784 5.72C0.784 4.58933 0.976 3.624 1.36 2.824C1.75467 2.024 2.29867 1.41067 2.992 0.983999C3.68533 0.557333 4.48533 0.344 5.392 0.344C6.30933 0.344 7.11467 0.557333 7.808 0.983999C8.50133 1.41067 9.04 2.024 9.424 2.824C9.81867 3.624 10.016 4.58933 10.016 5.72C10.016 6.85067 9.81867 7.82667 9.424 8.648C9.04 9.45867 8.50133 10.088 7.808 10.536C7.11467 10.9733 6.30933 11.192 5.392 11.192ZM5.392 9.576C6.21333 9.576 6.86933 9.22933 7.36 8.536C7.85067 7.832 8.096 6.89333 8.096 5.72C8.096 4.54667 7.85067 3.62933 7.36 2.968C6.86933 2.296 6.21333 1.96 5.392 1.96C4.57067 1.96 3.91467 2.296 3.424 2.968C2.93333 3.62933 2.688 4.54667 2.688 5.72C2.688 6.89333 2.93333 7.832 3.424 8.536C3.91467 9.22933 4.57067 9.576 5.392 9.576Z",fill:"black"})),s.createElement("defs",null,s.createElement("clipPath",{id:"clip0_751_38745"},s.createElement("rect",{width:1440,height:812,fill:"white",transform:"translate(-1203 -745)"})))),Oe=l=>s.createElement("svg",{width:18,height:15,viewBox:"0 0 18 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",...l},s.createElement("rect",{width:18,height:15,fill:"#F5F5F5"}),s.createElement("g",{clipPath:"url(#clip0_751_38745)"},s.createElement("rect",{width:1440,height:812,transform:"translate(-1307 -745)",fill:"white"}),s.createElement("path",{d:"M0.328 11V0.535999H8.136V11H6.28V2.104H2.184V11H0.328ZM10.6368 14.104V3.144H12.1568L12.2848 3.976H12.3488C12.6794 3.69867 13.0474 3.45867 13.4528 3.256C13.8688 3.05333 14.2901 2.952 14.7168 2.952C15.6981 2.952 16.4554 3.31467 16.9888 4.04C17.5328 4.76533 17.8048 5.736 17.8048 6.952C17.8048 7.848 17.6448 8.616 17.3248 9.256C17.0048 9.88533 16.5888 10.3653 16.0768 10.696C15.5754 11.0267 15.0314 11.192 14.4448 11.192C14.1034 11.192 13.7621 11.1173 13.4208 10.968C13.0794 10.808 12.7488 10.5947 12.4288 10.328L12.4768 11.64V14.104H10.6368ZM14.0608 9.672C14.5834 9.672 15.0208 9.44267 15.3728 8.984C15.7248 8.52533 15.9008 7.85333 15.9008 6.968C15.9008 6.17867 15.7674 5.56533 15.5008 5.128C15.2341 4.69067 14.8021 4.472 14.2048 4.472C13.6501 4.472 13.0741 4.76533 12.4768 5.352V9.016C12.7648 9.25067 13.0421 9.42133 13.3088 9.528C13.5754 9.624 13.8261 9.672 14.0608 9.672Z",fill:"#FF3B30"})),s.createElement("defs",null,s.createElement("clipPath",{id:"clip0_751_38745"},s.createElement("rect",{width:1440,height:812,fill:"white",transform:"translate(-1307 -745)"})))),it=({id:l,shift:p})=>{var de;const{t:r}=ye(),L=Ce(),[U,f]=s.useState(new Date),[J,z]=s.useState(new Date),b=Se();s.useEffect(()=>{var t,n;(t=p==null?void 0:p.props)!=null&&t.startDate&&((n=p==null?void 0:p.props)!=null&&n.endDate)&&(f(p.props.startDate),z(p.props.endDate))},[p]);const{data:_}=P(["get-pos",b],()=>be({placementId:b}),{revalidateOnFocus:!1,revalidateOnReconnect:!1,keepPreviousData:!0}),{data:F}=P(["get-worker"],()=>Ue(),{revalidateOnFocus:!1,revalidateOnReconnect:!1,keepPreviousData:!0}),N=s.useMemo(()=>(_==null?void 0:_.map(t=>({name:t.name,value:t.id})))||[],[_]),W=s.useMemo(()=>(F==null?void 0:F.map(t=>({name:t.name,value:t.id,surname:t.surname})))||[],[F]),{data:w}=P((de=L.state)!=null&&de.ownerId?["get-shift-data"]:null,()=>{var t;return _e((t=L.state)==null?void 0:t.ownerId)},{revalidateOnFocus:!1,revalidateOnReconnect:!1,keepPreviousData:!0}),E=[],[Q,G]=s.useState({}),[u,y]=s.useState({}),[T,q]=s.useState(null),[D,A]=s.useState(""),[H,M]=s.useState(E),[C,c]=s.useState(0),[K,te]=s.useState(0),[x,X]=s.useState(""),[Me,B]=s.useState(!1),Ve=Je(),$e=Qe(),[Re,Ae]=s.useState($e),{register:k,handleSubmit:He,setValue:j,watch:S,reset:ae,errors:V}=Fe({prize:void 0,fine:void 0,comment:"",typeWorkDay:"WEEKEND",estimation:void 0,timeWorkedOut:"",startWorkingTime:"",endWorkingTime:"",hours_timeWorkedOut:"",minutes_timeWorkedOut:"",hours_startWorkingTime:"",minutes_startWorkingTime:"",hours_endWorkingTime:"",minutes_endWorkingTime:""}),{trigger:Ke,isMutating:Pe}=Y(C!==0?["add-worker"]:null,(t,{arg:n})=>Xe(n,l)),{trigger:Le}=Y(["create-day"],async(t,{arg:n})=>et(n)),{trigger:ze,isMutating:Ge}=Y(["update-day-shift"],async(t,{arg:n})=>tt(n,n.id)),se=S("prize"),ne=S("fine"),re=S("comment"),I=S("typeWorkDay"),ie=S("estimation"),g=S(),oe=(t,n,i)=>{const a=new Date(t);return a.setUTCHours(parseInt(n,10)),a.setUTCMinutes(parseInt(i,10)),a.toISOString()},$=(t,n,i)=>{const a=`hours_${t}`,d=`minutes_${t}`,o=D.slice(0,10),m=D.slice(0,10);j(n==="hours"?a:d,i);const h=n==="hours"?i:String(g[a]||"00"),v=n==="minutes"?i:String(g[d]||"00");h!==""&&v!==""&&(t==="startWorkingTime"&&o?j(t,oe(o,h,v)):t==="endWorkingTime"&&m?j(t,oe(m,h,v)):j(t,h.padStart(2,"0")+":"+v.padStart(2,"0")))},qe=async(t,n)=>{var o,m;const i=`${t.userId}-${n}`;G(h=>({...h,[i]:!0})),q(t),A(n);const a=await Le({shiftReportId:l,userId:t.userId,workDate:new Date(n)});te(a==null?void 0:a.id),X((a==null?void 0:a.status)||"");const d={typeWorkDay:(a==null?void 0:a.typeWorkDay)||"",timeWorkedOut:(a==null?void 0:a.timeWorkedOut)||"",hours_timeWorkedOut:((o=a.timeWorkedOut)==null?void 0:o.split(":")[0])||"",minutes_timeWorkedOut:((m=a.timeWorkedOut)==null?void 0:m.split(":")[1])||"",startWorkingTime:a!=null&&a.startWorkingTime?new Date(a.startWorkingTime).toISOString():"",hours_startWorkingTime:a!=null&&a.startWorkingTime?new Date(a.startWorkingTime).getUTCHours().toString().padStart(2,"0"):"",minutes_startWorkingTime:a!=null&&a.startWorkingTime?new Date(a.startWorkingTime).getUTCMinutes().toString().padStart(2,"0"):"",endWorkingTime:a!=null&&a.endWorkingTime?new Date(a.endWorkingTime).toISOString():"",hours_endWorkingTime:a!=null&&a.endWorkingTime?new Date(a.endWorkingTime).getUTCHours().toString().padStart(2,"0"):"",minutes_endWorkingTime:a!=null&&a.endWorkingTime?new Date(a.endWorkingTime).getUTCMinutes().toString().padStart(2,"0"):"",estimation:(a==null?void 0:a.estimation)||void 0,prize:(a==null?void 0:a.prize)??void 0,fine:(a==null?void 0:a.fine)??void 0,comment:(a==null?void 0:a.comment)||""};y(h=>({...h,[i]:d})),ae(d)},le=()=>{if(!T||!D)return;const t=`${T.userId}-${D}`,n=S(),i={typeWorkDay:n.typeWorkDay,timeWorkedOut:n.timeWorkedOut||"",hours_timeWorkedOut:n.hours_timeWorkedOut||"",minutes_timeWorkedOut:n.minutes_timeWorkedOut||"",startWorkingTime:n.startWorkingTime||"",hours_startWorkingTime:n.hours_startWorkingTime||"",minutes_startWorkingTime:n.minutes_startWorkingTime||"",endWorkingTime:n.endWorkingTime||"",hours_endWorkingTime:n.hours_endWorkingTime||"",minutes_endWorkingTime:n.minutes_endWorkingTime||"",estimation:n.estimation??void 0,prize:n.prize??void 0,fine:n.fine??void 0,comment:n.comment||""};y(a=>({...a,[t]:i})),G(a=>({...a,[t]:!1})),q(null),A("")};s.useEffect(()=>{var t;if((t=w==null?void 0:w.workers)!=null&&t.length){const n=w.workers.map(a=>{var d,o;return{id:a.workerId,name:`${a.name} ${a.middlename} ${a.surname}`,branch:((d=N.find(m=>m.value===w.posId))==null?void 0:d.name)||"",position:a.position,userId:((o=W.find(m=>m.surname===a.surname))==null?void 0:o.value)||0}}),i={};w.workers.forEach(a=>{var d;(d=a.workDays)==null||d.forEach(o=>{const m=`${a.workerId}-${o.workDate}`;i[m]={typeWorkDay:o.typeWorkDay,timeWorkedOut:o.timeWorkedOut,estimation:o.estimation,prize:o.prize,fine:o.fine}})}),y(a=>JSON.stringify(a)===JSON.stringify(i)?a:i),M(a=>JSON.stringify(a)===JSON.stringify(n)?a:[...n]),f(w.startDate),z(w.endDate),Ae(w.posId)}else M([])},[w,u,W,N]);const ce=((t,n)=>{const i=[],a=["ВС","ПН","ВТ","СР","ЧТ","ПТ","СБ"],d=new Date(t),o=new Date(n),m=d.getTime(),h=o.getTime();for(let v=m;v<=h;v+=864e5){const R=new Date(v);i.push({day:a[R.getDay()],date:R.getDate().toString(),workDate:R.toISOString()})}return i})(U,J),Be=async()=>{if(C)try{const t=await Ke({userId:C});if(t){const n=t.workers.map(i=>{var a,d;return{id:i.workerId,name:i.name+" "+i.middlename+" "+i.surname,branch:((a=N.find(o=>o.value===t.posId))==null?void 0:a.name)||"",position:i.position,userId:((d=W.find(o=>o.name===i.name))==null?void 0:d.value)||0}});M([...n]),B(!1)}else console.error("Adding worker did not return expected data:",t)}catch(t){console.error("Error adding worker:",t)}},Ye=t=>{c(t)},Ze=async()=>{var n,i,a,d;const t=await ze({id:K,typeWorkDay:I,timeWorkedOut:g.timeWorkedOut,startWorkingTime:g.startWorkingTime?new Date(g.startWorkingTime):void 0,endWorkingTime:g.endWorkingTime?new Date(g.endWorkingTime):void 0,estimation:ie,prize:Number(se),fine:Number(ne),comment:re});if(t){if(ae({typeWorkDay:t.typeWorkDay,timeWorkedOut:t.timeWorkedOut,hours_timeWorkedOut:(n=t.timeWorkedOut)==null?void 0:n.split(":")[0],minutes_timeWorkedOut:(i=t.timeWorkedOut)==null?void 0:i.split(":")[1],startWorkingTime:t.startWorkingTime?new Date(t.startWorkingTime).toISOString():void 0,endWorkingTime:t.endWorkingTime?new Date(t.endWorkingTime).toISOString():void 0,estimation:t.estimation,prize:t.prize,fine:t.fine,comment:t.comment}),t.typeWorkDay==="WORKING"){const o=(a=W.find(h=>h.value===t.workerId))==null?void 0:a.name,m=(d=W.find(h=>h.value===t.workerId))==null?void 0:d.surname;Ve("/finance/timesheet/view",{state:{ownerId:t.id,posId:Re,name:`${o} ${m}`,date:t.workDate,status:t.status}})}nt(["get-shift-data"])}};return e.jsxs("div",{children:[l!==0&&H&&e.jsx("div",{className:"max-w-7xl overflow-x-auto",children:e.jsxs("table",{className:"w-fit table-fixed border-separate border-spacing-0.5",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-background02 bg-background06 px-2.5 py-5 text-start text-sm font-semibold text-text01 uppercase",children:[e.jsx("th",{className:"w-32 h-16",children:"Мойка/Филиал"}),e.jsx("th",{className:"w-60 h-16",children:"ФИО Сотрудника"}),ce.map((t,n)=>e.jsxs("th",{className:"border-b border-background02 bg-background06 px-2.5 py-5 text-start text-sm font-semibold text-text01 uppercase tracking-wider w-16 h-16",children:[t.day," ",e.jsx("br",{})," ",t.date]},n))]})}),e.jsx("tbody",{children:H.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"border-b border-b-[#E4E5E7] bg-background02 py-2 px-2.5 text-start text-sm font-semibold text-primary02 w-32 h-16",children:t.branch}),e.jsxs("td",{className:"border-b border-b-[#E4E5E7] bg-background02 py-2 px-2.5 text-start text-sm text-text01 w-60 h-16",children:[e.jsx("span",{className:"text-primary02 font-semibold text-sm",children:t.name})," ",e.jsx("br",{}),e.jsx("span",{className:"text-text02 text-sm",children:t.position})]}),ce.map((n,i)=>{var a,d,o,m,h,v,R,me,ue,he,xe,ge,pe,fe;return e.jsx("td",{className:`border border-borderFill w-16 h-16
                                    ${((a=u[`${t.userId}-${n.workDate}`])==null?void 0:a.typeWorkDay)==="WORKING"?"bg-[#DDF5FF]":"bg-background02"} 
                                    cursor-pointer hover:bg-background05 text-sm text-text01`,onClick:()=>qe(t,n.workDate),children:e.jsxs("div",{className:"flex flex-col justify-between overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-center",children:[" ",(d=u[`${t.userId}-${n.workDate}`])!=null&&d.timeWorkedOut?e.jsx("div",{children:(o=u[`${t.userId}-${n.workDate}`])==null?void 0:o.timeWorkedOut}):((m=u[`${t.userId}-${n.workDate}`])==null?void 0:m.typeWorkDay)==="MEDICAL"?e.jsx(je,{}):((h=u[`${t.userId}-${n.workDate}`])==null?void 0:h.typeWorkDay)==="VACATION"?e.jsx(Ie,{}):((v=u[`${t.userId}-${n.workDate}`])==null?void 0:v.typeWorkDay)==="TIMEOFF"?e.jsx(Ee,{}):((R=u[`${t.userId}-${n.workDate}`])==null?void 0:R.typeWorkDay)==="TRUANCY"?e.jsx(Oe,{}):e.jsx(e.Fragment,{})]}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[" ",((me=u[`${t.userId}-${n.workDate}`])==null?void 0:me.estimation)==="GROSS_VIOLATION"?e.jsx(De,{className:"w-2 h-2"}):((ue=u[`${t.userId}-${n.workDate}`])==null?void 0:ue.estimation)==="MINOR_VIOLATION"?e.jsx(Ne,{className:"w-2 h-2"}):((he=u[`${t.userId}-${n.workDate}`])==null?void 0:he.estimation)==="ONE_REMARK"?e.jsx(Te,{className:"w-2 h-2"}):e.jsx(e.Fragment,{}),e.jsxs("div",{className:"flex ml-auto space-x-1",children:[e.jsx("div",{className:"text-text02 text-xs max-w-[25px] overflow-hidden text-ellipsis whitespace-nowrap",children:(xe=u[`${t.userId}-${n.workDate}`])!=null&&xe.prize?`+${(ge=u[`${t.userId}-${n.workDate}`])==null?void 0:ge.prize}`:""}),e.jsx("div",{className:"text-text02 text-xs max-w-[25px] overflow-hidden text-ellipsis whitespace-nowrap",children:(pe=u[`${t.userId}-${n.workDate}`])!=null&&pe.fine?`-${(fe=u[`${t.userId}-${n.workDate}`])==null?void 0:fe.fine}`:""})]})]})]})},i)})]},t.id))})]})}),l!==0&&e.jsxs("div",{className:"mt-5 flex space-x-1 text-primary02 items-center cursor-pointer",onClick:()=>B(!0),children:[e.jsx(at,{icon:"plus",className:"w-5 h-5"}),e.jsx("div",{children:r("finance.addE")})]}),l!==0&&e.jsx("div",{className:"mt-5",children:e.jsxs("div",{className:"flex flex-wrap justify-center gap-x-10 sm:gap-x-5 gap-y-3",children:[e.jsxs("div",{className:"flex space-x-2 items-center",children:[e.jsx(De,{}),e.jsx("div",{className:"text-text01",children:r("finance.GROSS_VIOLATION")})]}),e.jsxs("div",{className:"flex space-x-2 items-center",children:[e.jsx(Ne,{}),e.jsx("div",{className:"text-text01",children:r("finance.MINOR_VIOLATION")})]}),e.jsxs("div",{className:"flex space-x-2 items-center",children:[e.jsx(Te,{}),e.jsx("div",{className:"text-text01",children:r("finance.ONE_REMARK")})]})]})}),l!==0&&e.jsx("div",{className:"mt-5",children:e.jsxs("div",{className:"flex flex-wrap justify-center gap-x-10 sm:gap-x-5 gap-y-3",children:[e.jsxs("div",{className:"flex space-x-2 items-center",children:[e.jsx("div",{className:"w-4 h-4 bg-[#DDF5FF]"}),e.jsx("div",{className:"text-text01",children:r("finance.WORKING")})]}),e.jsxs("div",{className:"flex space-x-2 items-center",children:[e.jsx("div",{className:"w-4 h-4 border border-borderFill"}),e.jsx("div",{className:"text-text01",children:r("finance.WEEKEND")})]}),e.jsxs("div",{className:"flex space-x-2 items-center",children:[e.jsx(je,{}),e.jsx("div",{className:"text-text01",children:r("finance.MEDICAL")})]}),e.jsxs("div",{className:"flex space-x-2 items-center",children:[e.jsx(Ie,{}),e.jsx("div",{className:"text-text01",children:r("finance.VACATION")})]}),e.jsxs("div",{className:"flex space-x-2 items-center",children:[e.jsx(Ee,{}),e.jsx("div",{className:"text-text01",children:r("finance.TIMEOFF")})]}),e.jsxs("div",{className:"flex space-x-2 items-center",children:[e.jsx(Oe,{}),e.jsx("div",{className:"text-text01",children:r("finance.TRUANCY")})]})]})}),T&&D&&e.jsxs(we,{isOpen:Q[`${T.userId}-${D}`],classname:"max-h-[650px] px-8 py-8 overflow-y-auto",children:[e.jsxs("div",{className:"flex flex-row items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-lg font-semibold text-text01",children:[T.name,", смена: ",new Date(D).getDate()]}),e.jsx(ke,{onClick:le,className:"cursor-pointer text-text01"})]}),e.jsxs("form",{onSubmit:He(Ze),className:"text-text02",children:[e.jsx(Z,{title:r("finance.day"),...k("typeWorkDay"),value:I,options:[{name:r("finance.WORKING"),value:"WORKING"},{name:r("finance.WEEKEND"),value:"WEEKEND"},{name:r("finance.MEDICAL"),value:"MEDICAL"},{name:r("finance.VACATION"),value:"VACATION"},{name:r("finance.TIMEOFF"),value:"TIMEOFF"},{name:r("finance.TRUANCY"),value:"TRUANCY"}],classname:"w-80 sm:w-96 mb-4",onChange:t=>j("typeWorkDay",t),isDisabled:x==="SENT"}),I==="WORKING"&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("div",{children:r("finance.num")}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(O,{type:"number",placeholder:"00 ч",classname:"w-[68px]",...k("hours_timeWorkedOut",{required:I==="WORKING"?"Обязательное поле":!1}),value:g.hours_timeWorkedOut,changeValue:t=>$("timeWorkedOut","hours",t.target.value),error:!!V.hours_timeWorkedOut,disabled:x==="SENT"}),e.jsx(O,{type:"number",placeholder:"00 м",classname:"w-[70px]",...k("minutes_timeWorkedOut",{required:I==="WORKING"?"Обязательное поле":!1}),value:g.minutes_timeWorkedOut,changeValue:t=>$("timeWorkedOut","minutes",t.target.value),error:!!V.minutes_timeWorkedOut,disabled:x==="SENT"})]}),e.jsxs("div",{className:"flex space-x-8 mt-2",children:[e.jsxs("div",{children:[e.jsx("div",{children:r("finance.start")}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(O,{type:"number",placeholder:"00 ч",classname:"w-[68px]",...k("hours_startWorkingTime",{required:I==="WORKING"?"Обязательное поле":!1}),value:g.hours_startWorkingTime,changeValue:t=>$("startWorkingTime","hours",t.target.value),error:!!V.hours_startWorkingTime,disabled:x==="SENT"}),e.jsx(O,{type:"number",placeholder:"00 м",classname:"w-[70px]",...k("minutes_startWorkingTime",{required:I==="WORKING"?"Обязательное поле":!1}),value:g.minutes_startWorkingTime,changeValue:t=>$("startWorkingTime","minutes",t.target.value),error:!!V.minutes_startWorkingTime,disabled:x==="SENT"})]})]}),e.jsxs("div",{children:[e.jsx("div",{children:r("finance.endOf")}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(O,{type:"number",placeholder:"00 ч",classname:"w-[68px]",...k("hours_endWorkingTime",{required:I==="WORKING"?"Обязательное поле":!1}),value:g.hours_endWorkingTime,changeValue:t=>$("endWorkingTime","hours",t.target.value),error:!!V.hours_endWorkingTime,disabled:x==="SENT"}),e.jsx(O,{type:"number",placeholder:"00 м",classname:"w-[70px]",...k("minutes_endWorkingTime",{required:I==="WORKING"?"Обязательное поле":!1}),value:g.minutes_endWorkingTime,changeValue:t=>$("endWorkingTime","minutes",t.target.value),error:!!V.minutes_endWorkingTime,disabled:x==="SENT"})]})]})]})]}),e.jsxs("div",{className:"flex space-x-8",children:[e.jsx(O,{type:"number",title:r("finance.prize"),classname:"w-44",...k("prize"),value:se,changeValue:t=>j("prize",t.target.value),disabled:x==="SENT"}),e.jsx(O,{type:"number",title:r("finance.fine"),classname:"w-44",...k("fine"),value:ne,changeValue:t=>j("fine",t.target.value),disabled:x==="SENT"})]}),e.jsx(Z,{title:r("finance.grade"),...k("estimation"),value:ie,options:[{name:r("finance.NO_VIOLATION"),value:"NO_VIOLATION"},{name:r("finance.GROSS_VIOLATION"),value:"GROSS_VIOLATION"},{name:r("finance.MINOR_VIOLATION"),value:"MINOR_VIOLATION"},{name:r("finance.ONE_REMARK"),value:"ONE_REMARK"}],classname:"w-80 sm:w-96",onChange:t=>j("estimation",t),isDisabled:x==="SENT"}),e.jsx(st,{title:r("equipment.comment"),...k("comment"),value:re,changeValue:t=>j("comment",t.target.value),classname:"w-80 sm:w-96",inputType:"secondary",disabled:x==="SENT"})]}),e.jsxs("div",{className:"flex gap-3 mt-14",children:[e.jsx(ee,{title:r("warehouse.reset"),handleClick:le,type:"outline"}),e.jsx(ee,{title:r("finance.openR"),form:!0,isLoading:Ge})]})]})]}),e.jsxs(we,{isOpen:Me,onClose:()=>B(!1),handleClick:Be,loading:Pe,children:[e.jsxs("div",{className:"flex flex-row items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-text01",children:r("finance.addNew")}),e.jsx(ke,{onClick:()=>B(!1),className:"cursor-pointer text-text01"})]}),e.jsx("div",{className:"mt-5",children:e.jsx(Z,{value:C,options:W,onChange:Ye,classname:"w-[292px]"})})]})]})},ct=()=>{var D,A,H,M,C;const{t:l}=ye(),p=Se(),{data:r}=P(["get-pos",p],()=>be({placementId:p}),{revalidateOnFocus:!1,revalidateOnReconnect:!1,keepPreviousData:!0}),L=(r==null?void 0:r.map(c=>({name:c.name,value:c.id})))||[],U={posId:0,startDate:"",endDate:""},[f,J]=s.useState(U),[z,b]=s.useState(0),[_,F]=s.useState({}),N=Ce(),{register:W,handleSubmit:w,errors:E,setValue:Q}=Fe(f),{trigger:G,isMutating:u}=Y(["create-shift"],async()=>rt({startDate:new Date(f.startDate),endDate:new Date(f.endDate),posId:f.posId})),{data:y}=P(((D=N==null?void 0:N.state)==null?void 0:D.ownerId)!==0?["get-shift-data"]:null,()=>_e(N.state.ownerId),{revalidateOnFocus:!1,revalidateOnReconnect:!1,keepPreviousData:!0}),T=(c,K)=>{const x=["posId"].includes(c)?Number(K):K;J(X=>({...X,[c]:x})),Q(c,K)};s.useEffect(()=>{b(y?y.id:0)},[y]);const q=async()=>{try{const c=await G();if(c)b(c.props.id),F(c);else throw new Error("Invalid update data.")}catch(c){console.error("Error during form submission: ",c)}};return e.jsxs("div",{children:[((A=N.state)==null?void 0:A.ownerId)===0&&e.jsxs("form",{className:"space-y-6",onSubmit:w(q),children:[e.jsxs("div",{className:"flex space-x-4",children:[e.jsx(ve,{title:l("finance.start")+"*",value:f.startDate?We(f.startDate):null,changeValue:c=>T("startDate",c?c.format("YYYY-MM-DDTHH:mm"):""),error:!!E.startDate,helperText:((H=E.startDate)==null?void 0:H.message)||"",...W("startDate",{required:"Start DateTime is required"}),classname:"w-64"}),e.jsx(ve,{title:l("finance.end")+"*",value:f.endDate?We(f.endDate):null,changeValue:c=>T("endDate",c?c.format("YYYY-MM-DDTHH:mm"):""),error:!!E.endDate,helperText:((M=E.endDate)==null?void 0:M.message)||"",...W("endDate",{required:"End DateTime is required"}),classname:"w-64"})]}),e.jsx(Z,{title:l("finance.carWash"),options:L,classname:"w-64",...W("posId",{required:"Pos ID is required",validate:c=>c!==0||"Pos ID is required"}),value:f.posId,onChange:c=>T("posId",c),error:!!E.posId,helperText:(C=E.posId)==null?void 0:C.message}),e.jsx("div",{className:"flex justify-between",children:e.jsx(ee,{title:l("finance.form"),isLoading:u,form:!0})})]}),e.jsx("div",{className:"mt-10",children:e.jsx(it,{id:z,shift:_})})]})};export{ct as default};

import{d as C,r as o,aa as R,ab as v,y as A,z as L,j as s,ac as M,B as U}from"./index-C24s9YLx.js";import{b as V}from"./index-Bs2AcXlY.js";const K=({registerObj:i,count:f,setCount:x,setRegisterUser:g,setRegisterToken:d,setRegisterPermissions:h})=>{const{t:n}=C(),[c,b]=o.useState(Array(6).fill("")),[l,S]=o.useState(""),[m,u]=o.useState(!1),j=R(),y=v(),E={confirmString:""},[k,N]=o.useState(E),{handleSubmit:w,setValue:$}=A(k),{trigger:B,isMutating:F}=L("user/auth/activation",async()=>V({email:i.email,confirmString:`${l.substring(0,3)}-${l.substring(3)}`})),D=(t,e)=>{var r;if(/^[0-9]?$/.test(t)){const a=[...c];if(a[e]=t,b(a),e==5){const p=a.join("");S(p),$("confirmString",p),N(T=>({...T,confirmString:t}))}t&&e<5&&((r=document.getElementById(`otp-${e+1}`))==null||r.focus())}},I=t=>{var e;t>0&&c[t]===""&&((e=document.getElementById(`otp-${t-1}`))==null||e.focus())},O=async()=>{try{const t=await B();if(t&&t.admin&&t.tokens&&t.permissionInfo){const{admin:e,tokens:r,permissionInfo:a}=t;g(e==null?void 0:e.props),d(r),y({tokens:r}),h(a.permissions),x(f+1)}else u(!0)}catch{u(!0),j()}};return s.jsxs("div",{children:[s.jsx("p",{className:"text-3xl font-extrabold leading-[1.25] text-text01 mb-1 mt-16",children:n("register.enter")}),s.jsx("p",{className:"font-normal text-text01 text-base",children:n("register.otpEmail")}),s.jsx("p",{className:"font-normal text-text01 text-base",children:i.email}),s.jsxs("form",{className:"space-y-6",onSubmit:w(O),children:[s.jsx("div",{className:"flex justify-center space-x-4 mt-10",children:c.map((t,e)=>s.jsxs(M.Fragment,{children:[s.jsx("input",{id:`otp-${e}`,type:"text",maxLength:1,value:t,onChange:r=>D(r.target.value,e),onKeyDown:r=>r.key==="Backspace"&&I(e),className:`w-8 h-12 text-center bg-background02 text-text01 border ${m?"border-errorFill":"border-[#E4E5E7]"} rounded-lg text-2xl focus:outline-none`}),e===2&&s.jsx("span",{className:"text-2xl text-[#e4e5e7] font-semibold self-center",children:"-"})]},e))}),m&&s.jsx("p",{className:"text-errorFill text-center mt-2",children:n("register.wrong")}),s.jsx(U,{type:"basic",title:n("register.register"),form:!0,classname:"w-full",isLoading:F})]})]})};export{K as default};

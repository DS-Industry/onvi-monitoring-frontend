import{e as T,d as V,k as q,b as M,f as Y,a2 as E,q as P,g as A,v as l,bu as C,b3 as G,bk as Q,r as F,j as s,bz as L,K as S,aP as z,aq as N,L as j}from"./index-C24s9YLx.js";import{G as H}from"./GoodsAntTable-BYeoeGB0.js";import{g as W}from"./index-Dx68t6LI.js";const J=()=>{var b;const r=T(),{t}=V(),o=q(),{buttonOn:u}=M(),d=Y(),g=E(),x=P(),v=A(),{data:e,isLoading:I,isValidating:D}=l(["get-document"],()=>C(r.state.ownerId),{revalidateOnFocus:!1,revalidateOnReconnect:!1,keepPreviousData:!0}),{data:i}=l(["get-org"],()=>W({placementId:x})),f=(i==null?void 0:i.map(a=>({name:a.name,value:a.id})))||[],{data:m}=l(f?["get-inventory"]:null,()=>G(f[0].value),{revalidateOnFocus:!1,revalidateOnReconnect:!1,keepPreviousData:!0}),h=(m==null?void 0:m.map(a=>({name:a.props.name,value:a.props.id})))||[],{data:c}=l(["get-warehouse"],()=>Q({posId:g,placementId:x}),{revalidateOnFocus:!1,revalidateOnReconnect:!1,keepPreviousData:!0}),y=(c==null?void 0:c.map(a=>({name:a.props.name,value:a.props.id})))||[],k=o==="INVENTORY"?[{label:"№",key:"id"},{label:"Ответственный",key:"responsibleName"},{label:"Номенклатура",key:"nomenclatureName"},{label:"Кол-во",key:"quantity"},{label:"Комментарий",key:"comment"},{label:"Кол-во учет",key:"oldQuantity"},{label:"Отклонение",key:"deviation"}]:[{label:"№",key:"id"},{label:"Ответственный",key:"responsibleName"},{label:"Номенклатура",key:"nomenclatureName"},{label:"Кол-во",key:"quantity"},{label:"Комментарий",key:"comment"}];function w(a){return!!a&&"oldQuantity"in a&&"deviation"in a}function O(a){return!!a&&"warehouseReceirId"in a}const R=o==="INVENTORY"?((e==null?void 0:e.details)||[]).map(a=>{var n;return{id:a.props.id,responsibleName:v.name,nomenclatureName:((n=h.find(p=>p.value===a.props.nomenclatureId))==null?void 0:n.name)||"",quantity:a.props.quantity,comment:a.props.comment,oldQuantity:w(a.props.metaData)?a.props.metaData.oldQuantity:0,deviation:w(a.props.metaData)?a.props.metaData.deviation:0}}):((e==null?void 0:e.details)||[]).map(a=>{var n;return{id:a.props.id,responsibleName:v.name,nomenclatureName:((n=h.find(p=>p.value===a.props.nomenclatureId))==null?void 0:n.name)||"",quantity:a.props.quantity,comment:a.props.comment}});return F.useEffect(()=>{u&&d("/warehouse/documents/creation",{state:{ownerId:r.state.ownerId}})},[u,r.state.ownerId,d]),s.jsx("div",{children:I||D?s.jsx("div",{className:"mt-16",children:s.jsx(L.Input,{style:{width:"100%",height:"300px"},active:!0,block:!0})}):s.jsxs("div",{children:[s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 py-4",children:[s.jsxs("div",{className:"flex flex-wrap gap-4",children:[s.jsxs("div",{className:"flex",children:[s.jsxs("div",{className:"mr-10 text-text01 font-normal text-sm",children:[s.jsx("div",{children:t("warehouse.no")}),s.jsx("div",{children:t("warehouse.overhead")})]}),s.jsx(S,{type:"",value:e==null?void 0:e.document.props.name,changeValue:()=>{},disabled:!0})]}),s.jsxs("div",{className:"flex",children:[s.jsx("div",{className:"flex mt-3 text-text01 font-normal text-sm mx-2",children:t("warehouse.from")}),s.jsx(z,{value:e!=null&&e.document.props.createdAt?N(e==null?void 0:e.document.props.createdAt):null,changeValue:()=>{},disabled:!0})]})]}),s.jsxs("div",{className:"flex flex-col space-y-6",children:[s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("div",{className:"flex items-center sm:justify-center sm:w-64 text-text01 font-normal text-sm",children:t(o==="MOVING"?"warehouse.warehouseSend":"warehouse.ware")}),s.jsx(j,{value:e==null?void 0:e.document.props.warehouseId,options:y,classname:"w-48 sm:w-80",onChange:()=>{},isDisabled:!0})]}),o==="MOVING"&&s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("div",{className:"flex items-center sm:justify-center sm:w-64 text-text01 font-normal text-sm",children:t("warehouse.warehouseRec")}),s.jsx(j,{value:O(e==null?void 0:e.details[0].props.metaData)&&((b=e==null?void 0:e.details[0].props.metaData)==null?void 0:b.warehouseReceirId),options:y,classname:"w-48 sm:w-80",onChange:()=>{},isDisabled:!0})]})]})]}),s.jsx(H,{tableData:R,columns:k,showDocument:!0,documentName:e==null?void 0:e.document.props.name,documentTime:N(new Date((e==null?void 0:e.document.props.createdAt)??"")).format("DD.MM.YYYY HH:mm:ss")})]})})};export{J as default};

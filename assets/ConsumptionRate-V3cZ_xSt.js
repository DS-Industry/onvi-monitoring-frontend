import{d as I,a2 as O,r as m,q as k,v as f,w as z,b0 as E,z as M,b1 as A,j as s,A as F,aA as L,D as W,b2 as x,G as q,H as B,B as C,M as U}from"./index-C24s9YLx.js";import{S as V}from"./NoEquipment-BCMrYMdq.js";const _=()=>{const{t:c}=I(),v=c("warehouse.all"),N=O(),[n,T]=m.useState(N),g=k(),{data:u}=f(["get-pos",g],()=>z({placementId:g}),{revalidateOnFocus:!1,revalidateOnReconnect:!1,keepPreviousData:!0}),{data:r,isLoading:y}=f(n!=="*"?["get-consumption-rate",n]:null,()=>E(n),{revalidateOnFocus:!1,revalidateOnReconnect:!1,keepPreviousData:!0}),{trigger:j,isMutating:R}=M(["patch-program-coeff",n],async(a,{arg:o})=>A(n,o)),h=(u==null?void 0:u.map(a=>({name:a.name,value:a.id})))||[],S={name:v,value:"*"};h.unshift(S);const[e,p]=m.useState(r);m.useEffect(()=>{if(r){const a=[...r].sort((o,l)=>o.programTypeName.localeCompare(l.programTypeName));p(a)}},[r]),m.useEffect(()=>{if(r){const a=[...r].sort((o,l)=>o.programTypeName.localeCompare(l.programTypeName));p(a)}},[r]);const P=(a,o,l)=>{p(t=>{const d=t==null?void 0:t.map(i=>i.id===a?{...i,[o]:l}:i);return d==null?void 0:d.sort((i,w)=>i.programTypeName.localeCompare(w.programTypeName))})},b=async()=>{if(e&&e.some(t=>t.literRate<0||t.concentration<0))return;const o=(e==null?void 0:e.map(t=>({programTechRateId:t.id,literRate:Number(t.literRate),concentration:Number(t.concentration)})))||[];await j({valueData:o})&&U(["get-consumption-rate",n])};return s.jsxs("div",{children:[s.jsx(F,{count:(e==null?void 0:e.length)!==void 0?e==null?void 0:e.length:0,hideCity:!0,hideDateTime:!0,hidePage:!0,hideSearch:!0,hideCancel:!0,children:s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-text02",children:c("equipment.carWash")}),s.jsx(L,{className:"w-full sm:w-80 h-10",options:h.map(a=>({label:a.name,value:a.value})),value:n,onChange:a=>T(a)})]})}),y?s.jsx(W,{columnCount:x.length}):e&&e.length>0?s.jsx("div",{className:"mt-8",children:s.jsx(q,{data:e,columns:x,handleChange:P})}):s.jsx(B,{title:c("chemical.noText"),description:c("chemical.dont"),children:s.jsx("img",{src:V,className:"mx-auto",loading:"lazy",alt:"CONSUMPTION"})}),e&&e.length>0&&s.jsxs("div",{className:"flex mt-4 space-x-4",children:[s.jsx(C,{title:c("organizations.cancel"),type:"outline",handleClick:()=>{},classname:"w-[168px]"}),s.jsx(C,{title:c("organizations.save"),form:!0,isLoading:R,handleClick:b,classname:"w-[168px]"})]})]})};export{_ as default};

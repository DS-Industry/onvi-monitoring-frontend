import{b as J,d as K,r,bh as Q,U as X,V as ee,bi as te,Z as se,_ as ae,q as ne,k as oe,bp as re,t as ce,f as ue,a2 as le,v as S,ah as de,bk as ie,bq as me,z as pe,br as Ie,j as s,D as he,bs as E,G as fe,H as ge,aB as Se,aC as Oe,L as Ne}from"./index-C24s9YLx.js";import{F as ve}from"./FilterMonitoring-DnjDobpT.js";import{N as Ee}from"./NoOverhead-DLWLoKhg.js";const we=()=>{const{buttonOn:D,setButtonOn:O}=J(),{t:a}=K(),x=a("warehouse.all"),y=new Date().toISOString().slice(0,10),[T,u]=r.useState(!1),l=Q(),w=X(),b=ee(),C=te(),M=se(),j=ae(),d=ne(),R=oe(),[i,k]=r.useState(R),F=re(),W=ce(),G=ue(),V=e=>e==="COMMISSIONING"?"COMMISSIONING":e==="WRITEOFF"?"WRITEOFF":e==="MOVING"?"MOVING":e==="INVENTORY"?"INVENTORY":"RECEIPT",N=le(),{data:m}=S(["get-worker"],()=>de(),{revalidateOnFocus:!1,revalidateOnReconnect:!1,keepPreviousData:!0}),{data:p}=S(N&&d?["get-warehouse"]:null,()=>ie({posId:N,placementId:d}),{revalidateOnFocus:!1,revalidateOnReconnect:!1,keepPreviousData:!0}),P=(m==null?void 0:m.map(e=>({name:e.name,value:e.id})))||[],I=(p==null?void 0:p.map(e=>({name:e.props.name,value:e.props.id})))||[],H={name:x,value:"*"};I.unshift(H);const L={dateStart:new Date(w.toString().slice(0,10)||"2024-01-01"),dateEnd:new Date(b.toString().slice(0,10)||`${y}`),warehouseId:l,placementId:d},[n,A]=r.useState(L),Y=e=>{A(t=>({...t,...e})),u(!0),e.warehouseId&&C(e.warehouseId),e.dateStart&&M(new Date(e.dateStart)),e.dateEnd&&j(new Date(e.dateEnd)),e.placementId&&W(e.placementId)},{data:h,isLoading:f,mutate:v}=S(l?["get-all-documents"]:null,()=>me({dateStart:n.dateStart,dateEnd:n.dateEnd,warehouseId:n.warehouseId,placementId:n.placementId}),{revalidateOnFocus:!1,revalidateOnReconnect:!1,keepPreviousData:!0});r.useEffect(()=>{v().then(()=>u(!1))},[n,v]),r.useEffect(()=>{f||u(!1)},[f]);const g=(h==null?void 0:h.map(e=>{var t,c;return{...e,warehouseName:((t=I.find(o=>o.value===e.warehouseId))==null?void 0:t.name)||"-",responsibleName:((c=P.find(o=>o.value===e.responsibleId))==null?void 0:c.name)||"-",status:a(`tables.${e.status}`),type:a(`routes.${e.type}`)}}))||[],B=[{name:a("routes.COMMISSIONING"),value:"COMMISSIONING"},{name:a("routes.WRITEOFF"),value:"WRITEOFF"},{name:a("routes.MOVING"),value:"MOVING"},{name:a("routes.INVENTORY"),value:"INVENTORY"},{name:a("routes.RECEIPT"),value:"RECEIPT"}],$=e=>{k(e),F(e)},{trigger:q,isMutating:z}=pe(["create-document"],(e,{arg:t})=>Ie(t)),U=async()=>{if(i){const e=V(i);try{const t=await q({type:e});if(t!=null&&t.props){const{id:c,name:o,carryingAt:_,status:Z}=t.props;G("/warehouse/documents/creation",{state:{ownerId:c,name:o,carryingAt:_,wareHouseId:l,status:Z}})}else console.error("Document creation did not return expected data:",t)}catch(t){console.error("Error creating document:",t)}}};return s.jsxs(s.Fragment,{children:[s.jsx(ve,{count:g.length,wareHousesSelect:I,handleDataFilter:Y,hideSearch:!0}),T||f?s.jsx(he,{columnCount:E.length}):g.length>0?s.jsx("div",{className:"mt-8",children:s.jsx(fe,{data:g,columns:E,isDisplayEdit:!0,isStatus:!0,navigableFields:[{key:"name",getPath:()=>"/warehouse/documents/view"}]})}):s.jsx(ge,{title:a("warehouse.noOverhead"),description:"",children:s.jsx("img",{src:Ee,className:"mx-auto",loading:"lazy",alt:"Documents"})}),s.jsxs(Se,{isOpen:D,onClose:()=>O(!1),handleClick:U,classname:"w-96 h-72",loading:z,children:[s.jsxs("div",{className:"flex flex-row items-center justify-between mb-4",children:[s.jsx("h2",{className:"text-2xl font-semibold text-text01",children:a("warehouse.createDoc")}),s.jsx("div",{className:"flex items-center gap-6",children:s.jsx(Oe,{onClick:()=>O(!1),className:"cursor-pointer"})})]}),s.jsx(Ne,{value:i,options:B,title:a("warehouse.docType"),label:a("warehouse.notSel"),classname:"w-80",onChange:$})]})]})};export{we as default};

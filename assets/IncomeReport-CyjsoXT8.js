import{d as k,e as N,f as S,a2 as D,q as M,v as r,w as z,ai as T,bk as V,z as Y,r as $,j as s,A as B,bz as f,aP as E,aq as W,L as d,K as x,B as q,a$ as A}from"./index-C24s9YLx.js";import{g as K,a as G}from"./index-CRRG72Lv.js";import{g as H}from"./index-Dx68t6LI.js";const X=()=>{const{t:c}=k(),w=N(),y=S(),m=D(),l=M(),{data:p}=r(["get-pos",l],()=>z({placementId:l}),{revalidateOnFocus:!1,revalidateOnReconnect:!1,keepPreviousData:!0}),{data:u}=r(m!=="*"?["get-device"]:null,()=>T(m),{revalidateOnFocus:!1,revalidateOnReconnect:!1,keepPreviousData:!0}),{data:g}=r(["get-warehouse"],()=>V({posId:m,placementId:l}),{revalidateOnFocus:!1,revalidateOnReconnect:!1,keepPreviousData:!0}),{data:h}=r(["get-organization"],()=>H({placementId:l}),{revalidateOnFocus:!1,revalidateOnReconnect:!1,keepPreviousData:!0}),{data:t,isLoading:j,isValidating:v}=r(["get-report"],()=>K(w.state.ownerId),{revalidateOnFocus:!1,revalidateOnReconnect:!1,keepPreviousData:!0}),{trigger:I,isMutating:R}=Y(t!=null&&t.id?["create-report"]:null,async()=>G({...n},t!=null&&t.id?t.id:0)),C=(p==null?void 0:p.map(e=>({name:e.name,value:e.id})))||[],O=(u==null?void 0:u.map(e=>({name:e.props.name,value:e.props.name})))||[],b=(g==null?void 0:g.map(e=>({name:e.props.name,value:e.props.id})))||[],P=(h==null?void 0:h.map(e=>({name:e.name,value:e.id})))||[],[n,F]=$.useState({}),o=(e,a)=>{F(i=>({...i,[e]:a}))},L=async e=>{if(e.preventDefault(),!(t!=null&&t.id)){console.error("Report ID is missing");return}const a=t.params.params.filter(i=>!n[i.name]||n[i.name].toString().trim()==="").map(i=>i.description||i.name);if(a.length>0){A.error(`Please fill in the following fields: ${a.join(", ")}`);return}try{await I(),y("/analysis/transactions")}catch(i){console.error("Error creating report:",i)}};return s.jsxs("div",{children:[s.jsx(B,{count:0,hideSearch:!0,hideCity:!0,hideDateTime:!0,children:void 0}),s.jsx("div",{className:"p-4 bg-white rounded-lg shadow-md",children:s.jsxs("form",{onSubmit:L,className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:c("analysis.repo")}),s.jsx("div",{className:"flex flex-wrap gap-4",children:j||v?s.jsxs("div",{className:"flex flex-wrap gap-4",children:[s.jsx(f.Input,{active:!0,style:{width:150,height:32}}),s.jsx(f.Input,{active:!0,style:{width:150,height:32}}),s.jsx(f.Input,{active:!0,style:{width:150,height:32}})]}):t&&t.params.params.map(e=>s.jsx("div",{children:e.type==="date"?s.jsx(E,{title:e.description,value:n[e.name]?W(n[e.name]):null,changeValue:a=>o(e.name,a?a.format("YYYY-MM-DD"):""),classname:"w-64"}):e.name.toLowerCase().includes("pos")?s.jsx(d,{title:e.description,value:n[e.name]||"",options:C,onChange:a=>o(e.name,a),classname:"w-64"}):e.name.toLowerCase().includes("device")?s.jsx(d,{title:e.description,value:n[e.name]||"",options:O,onChange:a=>o(e.name,a),classname:"w-64"}):e.name.toLowerCase().includes("warehouse")?s.jsx(d,{title:e.description,value:n[e.name]||"",options:b,onChange:a=>o(a.name,a),classname:"w-64"}):e.name.toLowerCase().includes("org")?s.jsx(d,{title:e.description,value:n[e.name]||"",options:P,onChange:a=>o(e.name,a),classname:"w-64"}):e.type==="number"?s.jsx(x,{title:c(`analysis.${e.name}`),type:"number",value:n[e.name]||"",changeValue:a=>o(e.name,Number(a.target.value)),classname:"w-64"}):s.jsx(x,{title:c(`analysis.${e.name}`),type:"text",value:n[e.name]||"",changeValue:a=>o(e.name,a.target.value),classname:"w-64"})},e.name))}),s.jsx(q,{title:c("analysis.add"),form:!0,isLoading:R})]})})]})};export{X as default};

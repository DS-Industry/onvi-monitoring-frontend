import{d as U,f as R,a9 as D,cE as I,r as n,aa as T,y as z,v as q,z as C,l as F,j as s,H as V,K as g,B,s as L}from"./index-C24s9YLx.js";import{g as W,c as H}from"./index-Bs2AcXlY.js";import{O as M}from"./OTPImage-C4CXmht8.js";import{O as K}from"./onvi_blue-CugkZB1f.js";import{N as A}from"./NoToken-B6HWJgwo.js";const Z=()=>{var x,f;const{t}=U(),p=R(),h=D(),[w]=I(),[j,c]=n.useState(!1),v=T(),b={password:"",confirmPassword:""},d=w.get("key")||"",[r,y]=n.useState(b),{register:m,handleSubmit:N,errors:o,setValue:P}=z(r),u=(e,a)=>{y(O=>({...O,[e]:a})),P(e,a)},{data:l}=q(["valid-user"],async()=>{var e;try{return await W(d)}catch(a){if(((e=a.response)==null?void 0:e.status)===404)return null;throw a}},{revalidateOnFocus:!1,revalidateOnReconnect:!1,keepPreviousData:!0,shouldRetryOnError:e=>{var a;return((a=e.response)==null?void 0:a.status)!==404}}),{trigger:S,isMutating:k}=C(["create-worker"],async()=>H({password:r.password},d)),E=async()=>{try{const e=await S();if(e&&e.user){const{user:a}=e;h({user:a==null?void 0:a.props}),i(t("roles.pass"),"success"),p("/login")}else throw new Error(t("Password change failed. Please try again."))}catch{v()}};n.useEffect(()=>{!l||!l.status||l.status!=="SUCCESS"?c(!0):c(!1)},[l]);const{showSnackbar:i}=F();return n.useEffect(()=>{L(i)},[i]),s.jsx("div",{children:j?s.jsx("div",{className:"flex flex-col justify-center items-center",children:s.jsx(V,{title:t("organizations.user"),description:"",children:s.jsx("img",{src:A,className:"mx-auto",loading:"lazy",alt:"Token"})})}):s.jsx("div",{className:"flex min-h-screen items-center justify-center bg-background02 p-4",children:s.jsxs("div",{className:"flex flex-col rounded-lg p-8 lg:flex-row md:p-0",children:[s.jsxs("div",{className:"lg:w-5/12 p-8 lg:ml-40",children:[s.jsxs("div",{className:"flex mb-5",children:[s.jsx("img",{src:K,className:"h-7 w-14",loading:"lazy",alt:"Onvi"}),s.jsx("div",{className:"text-primary02 font-semibold text-xs items-center justify-center flex ml-2",children:t("login.business")})]}),s.jsx("p",{className:"text-3xl font-extrabold leading-[1.25] text-text01 mt-20 mb-1",children:t("forgot.set")}),s.jsx("p",{className:"font-normal text-text01 text-base mb-5",children:t("forgot.please")}),s.jsxs("form",{className:"space-y-6",onSubmit:N(E),children:[s.jsx(g,{type:"password",title:t("login.password"),value:r.password,changeValue:e=>u("password",e.target.value),error:!!o.password,...m("password",{required:"Password is required",minLength:{value:6,message:"Password must be at least 6 characters"}}),helperText:((x=o.password)==null?void 0:x.message)||""}),s.jsx(g,{type:"password",title:t("profile.confirm"),value:r.confirmPassword,changeValue:e=>u("confirmPassword",e.target.value),error:!!o.confirmPassword,...m("confirmPassword",{required:"Password is required",minLength:{value:6,message:"Password must be at least 6 characters"},validate:e=>e===r.password||"Passwords do not match"}),helperText:((f=o.confirmPassword)==null?void 0:f.message)||""}),s.jsx("div",{className:"flex items-center justify-between mb-10",children:s.jsxs("label",{className:"inline-flex items-center",children:[s.jsx("input",{type:"checkbox",className:"rounded text-primary02 border-text02"}),s.jsx("span",{className:"ml-2 text-sm text-text02",children:t("login.remember")})]})}),s.jsx(B,{type:"basic",title:t("forgot.set"),form:!0,classname:"w-full",isLoading:k})]})]}),s.jsx("div",{className:"hidden lg:flex lg:w-8/12 rounded-r-lg items-center justify-center lg:ml-20",children:s.jsx("div",{className:"p-8",children:s.jsx("img",{src:M,alt:"Rocket illustration",className:"object-cover w-11/12 h-11/12",loading:"lazy"},"forgot-password")})})]})})})};export{Z as default};

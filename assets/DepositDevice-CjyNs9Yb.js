import{R as $,U as k,V as B,W as G,X as H,Y as V,Z as X,_ as Y,$ as Z,a0 as _,a1 as q,a2 as A,e as J,r as a,v as x,a3 as K,j as s,D as Q,a4 as P,G as F,H as w}from"./index-C24s9YLx.js";import{g as ee}from"./index-BzKdJFVM.js";import{F as te}from"./FilterMonitoring-DnjDobpT.js";import{S as se}from"./Saly-45-CS9u2NZ4.js";const re=()=>{var h,I;const j=new Date().toISOString().slice(0,10),n=$(),C=k(),y=B(),u=G(),f=H(),p=V(),T=X(),z=Y(),i=Z(),b=_(),v=q(),L=A(),r=J();a.useEffect(()=>{var e;(e=r.state)!=null&&e.ownerId&&p(r.state.ownerId)},[(h=r.state)==null?void 0:h.ownerId,p]);const[M,D]=a.useState(!1),N={dateStart:C||"2024-10-01 00:00",dateEnd:y||`${j} 23:59`,page:u,size:f,deviceId:n},[c,g]=a.useState(N);a.useEffect(()=>{i(1),g(e=>({...e,page:1}))},[r,i]);const{data:t,error:R,isLoading:m,mutate:E}=x(n?["get-pos-deposits-pos-devices",n]:null,()=>ee(n||0,{dateStart:c.dateStart,dateEnd:c.dateEnd,page:c.page,size:c.size})),O=(t==null?void 0:t.totalCount)||0,o=Math.ceil(O/f);a.useEffect(()=>{u>o&&(i(o>0?o:1),g(e=>({...e,page:o>0?o:1})))},[o,u,i]);const{data:l}=x(["get-device-pos"],()=>K(L)),U=e=>{g(d=>({...d,...e})),D(!0),e.dateStart&&T(e.dateStart),e.dateEnd&&z(e.dateEnd),e.deviceId&&p(e.deviceId),e.page&&i(e.page),e.size&&b(e.size)};a.useEffect(()=>{},[R]),a.useEffect(()=>{E().then(()=>D(!1))},[c,E]),a.useEffect(()=>{!m&&(t!=null&&t.totalCount)&&v(t==null?void 0:t.totalCount)},[t==null?void 0:t.totalCount,m,v]);const S=((I=t==null?void 0:t.oper)==null?void 0:I.map(e=>e).sort((e,d)=>new Date(e.dateOper).getTime()-new Date(d.dateOper).getTime()))||[],W=((l==null?void 0:l.map(e=>e).sort((e,d)=>e.props.id-d.props.id))||[]).map(e=>({name:e.props.name,value:e.props.id}));return s.jsxs(s.Fragment,{children:[s.jsx(te,{count:S.length,devicesSelect:W,handleDataFilter:U,hideCity:!0,hideSearch:!0,hideReset:!0}),M||m?s.jsx(Q,{columnCount:P.length}):S.length>0?s.jsx("div",{className:"mt-8",children:s.jsx(F,{data:S,columns:P,isDisplayEdit:!0,showPagination:!0})}):s.jsx(s.Fragment,{children:s.jsx(w,{title:"В этом разделе представленны операции",description:"У вас пока нету операций",children:s.jsx(se,{className:"mx-auto"})})})]})};export{re as default};

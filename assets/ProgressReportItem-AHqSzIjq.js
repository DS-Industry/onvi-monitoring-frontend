import{d as L,e as M,f as V,r as m,aq as C,v as R,aS as O,z as U,aT as H,j as e,D as W,aF as Y,F as k,aW as B,a_ as P,B as w,L as $,K as b,a$ as q,M as z}from"./index-C24s9YLx.js";import{D as _}from"./index-DAyk0lNe.js";import{L as f}from"./index-B-3ghycs.js";const N=[{name:"Ниже нормы",value:"belowNormal"},{name:"Норма",value:"normal"},{name:"Выше нормы",value:"aboveNormal"}],G=({type:i,value:n,onChange:c,location:o,t:d})=>{var x,j,p;switch(i){case"Text":return e.jsx(b,{type:"text",title:d("chemical.enter"),value:n,changeValue:l=>c(l.target.value||""),classname:"w-80",disabled:((x=o.state)==null?void 0:x.status)==="FINISHED"});case"Number":return e.jsx(b,{type:"number",title:d("chemical.enter"),value:n,changeValue:l=>{const g=l.target.value?l.target.value:0;c(g)},classname:"w-80",disabled:((j=o.state)==null?void 0:j.status)==="FINISHED"});case"SelectList":return e.jsx($,{title:d("chemical.select"),value:n,options:N,onChange:l=>c(l),classname:"w-80",isDisabled:((p=o.state)==null?void 0:p.status)==="FINISHED"});case"Checkbox":return e.jsx("input",{type:"checkbox",checked:!!n,onChange:l=>c(l.target.checked),className:"w-5 h-5"});default:return e.jsx("div",{children:"Unsupported type"})}},Q=()=>{const{t:i}=L(),n=M(),c=V(),[o,d]=m.useState({}),x=[{key:"1",label:"Name",children:n.state.name},{key:"2",label:"Type",children:n.state.type},{key:"3",label:"End Work Date",children:C(n.state.endDate).format("DD.MM.YYYY")}],p={customRequest:({file:t,onSuccess:s})=>{setTimeout(()=>{q.success(`${t.name} uploaded successfully.`),s("ok")},1e3)},showUploadList:!1},{data:l,isLoading:g}=R(["get-tech-task"],()=>{var t;return O((t=n.state)==null?void 0:t.ownerId)},{revalidateOnFocus:!1,revalidateOnReconnect:!1,keepPreviousData:!0}),r=m.useMemo(()=>(l==null?void 0:l.items)||[],[l]);m.useEffect(()=>{const t=r.reduce((s,a)=>(s[a.group]=!1,s),{});d(t)},[r]);const S=t=>{d(s=>({...s,[t]:!s[t]}))},I=m.useMemo(()=>r.reduce((t,s)=>(t[s.group]||(t[s.group]=[]),t[s.group].push(s),t[s.group].sort((a,u)=>a.id-u.id),t),{}),[r]),[h,v]=m.useState({}),{trigger:T,isMutating:D}=U(["create-tech-task"],async(t,{arg:s})=>{var a;return H((a=n.state)==null?void 0:a.ownerId,s,[])});m.useEffect(()=>{if(r.length>0){const t=r.reduce((s,a)=>(s[a.id]=a.value??"",s),{});v(t)}},[r]);const E=(t,s)=>{v(a=>({...a,[t]:s}))},F=async()=>{const t=Object.entries(h).map(([a,u])=>({itemValueId:Number(a),value:u}));await T({valueData:t})&&(z(["get-tech-task"]),c(-1))};return e.jsxs(e.Fragment,{children:[e.jsx(_,{items:x}),g?e.jsx(W,{columnCount:5}):e.jsx(f,{dataSource:Object.entries(I),renderItem:([t,s])=>e.jsx(f.Item,{className:"w-full",children:e.jsxs(Y,{className:"w-full",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx("div",{className:"cursor-pointer bg-background03 w-6 h-6 rounded text-text01 flex justify-center items-center",onClick:()=>S(t),children:o[t]?e.jsx(k,{icon:"chevron-up"}):e.jsx(k,{icon:"chevron-down"})}),e.jsx("div",{className:"text-lg md:text-2xl font-semibold text-text01",children:i(`chemical.${t}`)})]}),o[t]&&e.jsx(f,{dataSource:s,renderItem:a=>{var u;return e.jsx(f.Item,{className:"w-full",children:e.jsxs("div",{className:"flex flex-wrap w-full gap-4 my-4 items-start md:items-center",children:[e.jsxs("div",{className:"flex-1 min-w-[250px] max-w-full",children:[e.jsx("div",{className:"text-text01",children:a.title}),e.jsx("div",{className:"text-sm text-text02 max-w-sm",children:"Task description is simply dummy text of the printing and typesetting industry."}),n.state.status==="FINISHED"?e.jsx("div",{children:a.type==="SelectList"?(u=N.find(y=>y.value===h[a.id]))==null?void 0:u.name:h[a.id]}):e.jsx(G,{type:a.type,value:h[a.id],onChange:y=>E(a.id,y),location:n,t:i})]}),e.jsx("div",{className:"flex-1 min-w-[250px] max-w-full mt-4 md:mt-10",children:e.jsx(B,{...p,accept:"image/*",children:e.jsxs("div",{className:"w-[120px] h-[120px] border border-dashed flex items-center justify-center cursor-pointer rounded-md hover:border-primary flex-col transition",children:[e.jsx(P,{className:"text-2xl text-gray-500"}),e.jsx("div",{children:"Upload"})]})})})]})})}})]})})}),n.state.status!=="FINISHED"&&e.jsxs("div",{className:"flex justify-start space-x-4",children:[e.jsx(w,{title:i("organizations.cancel"),type:"outline",handleClick:()=>v({})}),e.jsx(w,{title:i("routine.done"),form:!0,isLoading:D,handleClick:F})]})]})};export{Q as default};

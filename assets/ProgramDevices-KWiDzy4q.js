import{d as B,e as G,r as n,a2 as J,U as K,V as Q,q as Y,a5 as w,Z as F,_ as ee,t as se,W as te,X as ae,$ as oe,a0 as ne,a1 as ce,f as re,v as j,w as ie,j as t,D as de,a6 as T,a7 as pe,H as le}from"./index-C24s9YLx.js";import{a as ue}from"./index-BzKdJFVM.js";import{F as me}from"./FilterMonitoring-DnjDobpT.js";import{S as ge}from"./Saly-45-CS9u2NZ4.js";const Ce=()=>{var E,N;const{t:p}=B(),b=p("warehouse.all"),x=new Date().toISOString().slice(0,10),l=G(),[L,h]=n.useState(!1),D=J(),z=K(),O=Q(),u=Y(),$=w(),k=F(),R=ee(),M=se(),i=te(),m=ae(),r=oe(),H=ne(),C=ce(),U=re(),V={dateStart:z||`${x} 00:00`,dateEnd:O||`${x} 23:59`,posId:D||((E=l.state)==null?void 0:E.ownerId),placementId:u,page:i,size:m},[a,g]=n.useState(V);n.useEffect(()=>{r(1),g(e=>({...e,page:1}))},[l,r]);const{data:s,error:W,isLoading:f,mutate:P}=j([`get-pos-programs-pos-${a.posId?a.posId:(N=l.state)==null?void 0:N.ownerId}`],()=>ue({dateStart:a.dateStart,dateEnd:a.dateEnd,posId:a==null?void 0:a.posId,placementId:a==null?void 0:a.placementId,page:i,size:m}),{revalidateOnFocus:!1,revalidateOnReconnect:!1,keepPreviousData:!0}),{data:S,isLoading:_,isValidating:q}=j(["get-pos",u],()=>ie({placementId:u}),{revalidateOnFocus:!1,revalidateOnReconnect:!1,keepPreviousData:!0}),A=(s==null?void 0:s.totalCount)||0,c=Math.ceil(A/m);n.useEffect(()=>{i>c&&(r(c>0?c:1),g(e=>({...e,page:c>0?c:1})))},[c,i,r]);const X=e=>{g(o=>({...o,...e})),h(!0),e.posId&&$(e.posId),e.dateStart&&k(e.dateStart),e.dateEnd&&R(e.dateEnd),e.placementId&&M(e.placementId),e.page&&r(e.page),e.size&&H(e.size)};n.useEffect(()=>{},[W]),n.useEffect(()=>{P().then(()=>h(!1))},[a,P]),n.useEffect(()=>{!f&&(s!=null&&s.totalCount)&&C(s==null?void 0:s.totalCount)},[s,f,C]);const d=(s==null?void 0:s.prog.map(e=>e).sort((e,o)=>e.id-o.id))||[],y=((S==null?void 0:S.map(e=>e).sort((e,o)=>e.id-o.id))||[]).map(e=>({name:e.name,value:e.id})),Z={name:b,value:"*"};return y.unshift(Z),t.jsxs(t.Fragment,{children:[t.jsx(me,{count:d.length,posesSelect:y,handleDataFilter:X,hideSearch:!0,loadingPos:_||q}),L||f?t.jsx("div",{className:"mt-8 space-y-6",children:t.jsx("div",{children:t.jsx(de,{columnCount:T.length})})}):d.length>0?t.jsx("div",{className:"mt-8 space-y-6",children:t.jsx(pe,{data:d.flatMap((e,o)=>e.programsInfo?e.programsInfo.map((v,I)=>({id:`${o}-${I}`,deviceId:e.id,deviceName:e.name,...v})).sort((v,I)=>v.deviceName.toLowerCase().localeCompare(I.deviceName.toLowerCase())):[]),columns:T,titleColumns:[{label:"Device Name",key:"deviceName",render:(e,o)=>t.jsx("span",{className:"font-semibold text-primary02 hover:text-primary02_Hover cursor-pointer",onClick:()=>U("/station/programs/devices",{state:{ownerId:o.deviceId}}),children:e})}],titleData:d.map(e=>({title:e.name,deviceName:e.name,deviceId:e.id})).sort((e,o)=>e.deviceName.toLowerCase().localeCompare(o.deviceName.toLowerCase())),showPagination:!0})}):t.jsx(t.Fragment,{children:t.jsx(le,{title:p("pos.this"),description:p("pos.you"),children:t.jsx(ge,{className:"mx-auto"})})})]})};export{Ce as default};

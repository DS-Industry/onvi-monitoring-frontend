import{d as Te,r as l,b as qe,q as Oe,t as Fe,X as se,a0 as Le,W as We,bj as Me,$ as Re,a1 as $e,e as Ye,v as I,x as _e,cF as Be,cG as Ae,y as He,z as Ge,cH as Je,j as a,A as Ke,aA as ne,I as Qe,D as Ue,cI as re,G as Xe,J as Ze,K as c,L as j,aP as ie,aq as le,Q as ea,B as oe,M as aa}from"./index-C24s9YLx.js";import{N as ce}from"./Notification-KpAXhuNN.js";import{g as ta}from"./index-Dx68t6LI.js";const sa="data:image/svg+xml,%3csvg%20width='40'%20height='40'%20viewBox='0%200%2040%2040'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3crect%20width='40'%20height='40'%20fill='%23F5F5F5'/%3e%3cg%20clip-path='url(%23clip0_751_38745)'%3e%3crect%20width='1440'%20height='1946'%20transform='translate(-664%20-1028)'%20fill='white'/%3e%3crect%20width='1440'%20height='1946'%20transform='translate(-664%20-1028)'%20fill='black'%20fill-opacity='0.5'/%3e%3crect%20width='800'%20height='1946'%20transform='translate(-24%20-1028)'%20fill='white'/%3e%3cg%20clip-path='url(%23clip1_751_38745)'%3e%3crect%20width='40'%20height='40'%20rx='20'%20fill='%23D9D9D9'%20fill-opacity='0.5'/%3e%3cpath%20d='M3.09961%2040.24L36.8105%2040.2399C36.4551%2036.0645%2032.893%2032.8198%2028.6253%2032.9383L26.0906%2032.8281C24.6533%2032.7656%2023.5993%2031.4525%2023.8493%2030.0357L24.0618%2028.8312L24.3582%2027.6456C24.4084%2027.445%2024.4842%2027.2528%2024.5831%2027.0734C26.0137%2025.8575%2027.1192%2024.0729%2027.7042%2021.9169C28.3165%2021.5604%2029.0805%2019.9199%2029.0805%2019.2479C29.0805%2018.5566%2028.8898%2017.7942%2028.1595%2017.6686C28.0258%2011.9302%2026.1053%207.38281%2019.9529%207.38281C19.9524%207.38281%2019.9516%207.38281%2019.9512%207.38281C13.8022%207.385%2011.8826%2011.9316%2011.749%2017.6686C11.0187%2017.7942%2010.8279%2018.5566%2010.8279%2019.2479C10.8279%2019.9199%2011.5919%2021.5604%2012.2043%2021.9169C12.7897%2024.0745%2013.8963%2025.8601%2015.3284%2027.0759C15.4266%2027.2546%2015.5019%2027.446%2015.5518%2027.6456L15.8482%2028.8312L16.0608%2030.0357C16.3108%2031.4525%2015.2568%2032.7657%2013.8195%2032.8282L11.2848%2032.9384C7.01713%2032.8198%203.45505%2036.0645%203.09961%2040.24Z'%20fill='%23D8D9DD'/%3e%3c/g%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_751_38745'%3e%3crect%20width='1440'%20height='1946'%20fill='white'%20transform='translate(-664%20-1028)'/%3e%3c/clipPath%3e%3cclipPath%20id='clip1_751_38745'%3e%3crect%20width='40'%20height='40'%20rx='20'%20fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",la=()=>{var K,Q,U,X,Z,ee,ae,te;const{t}=Te(),L=t("warehouse.all"),[de,ue]=l.useState(!0),[pe,me]=l.useState(!0),{buttonOn:W,setButtonOn:M}=qe(),[S,w]=l.useState(void 0),[b,P]=l.useState("*"),[C,N]=l.useState("*"),[he,ge]=l.useState(null),[xe,R]=l.useState(null),[ve,$]=l.useState(!1),x=Oe(),z=Fe(),Y=se(),ye=Le(),v=We(),{filterOn:fe}=Me(),y=Re(),_=$e(),Ie=Ye(),je=se(),{data:D}=I(["get-city"],()=>_e(),{revalidateOnFocus:!1,revalidateOnReconnect:!1,keepPreviousData:!0}),{data:k}=I(["get-organization"],()=>ta({placementId:x}),{revalidateOnFocus:!1,revalidateOnReconnect:!1,keepPreviousData:!0}),{data:E}=I(["get-positions"],()=>Be(),{revalidateOnFocus:!1,revalidateOnReconnect:!1,keepPreviousData:!0}),V=(D==null?void 0:D.map(e=>({name:e.region,value:e.id})))||[],f=(k==null?void 0:k.map(e=>({name:e.name,value:e.id,label:e.name})))||[],B={name:L,value:"*",label:L},T=(E==null?void 0:E.map(e=>({name:e.props.name,value:e.props.id,label:e.props.name})))||[],{data:d,isLoading:q,mutate:A}=I(["get-workers"],()=>Ae({placementId:p.placementId,hrPositionId:p.hrPositionId,organizationId:p.organizationId,name:p.name,page:p.page,size:p.size}),{revalidateOnFocus:!1,revalidateOnReconnect:!1,keepPreviousData:!0}),H=(d==null?void 0:d.map(e=>{var o,g,u;return{...e.props,placement:(o=V.find(m=>m.value===e.props.placementId))==null?void 0:o.name,organization:(g=f.find(m=>m.value===e.props.organizationId))==null?void 0:g.name,position:(u=T.find(m=>m.value===e.props.hrPositionId))==null?void 0:u.name}}))||[],Se={placementId:x,hrPositionId:C,organizationId:b,name:S,page:v,size:Y};l.useEffect(()=>{y(1),O(e=>({...e,page:1}))},[Ie,y]);const[p,O]=l.useState(Se),we=(d==null?void 0:d.length)||0,h=Math.ceil(we/je);l.useEffect(()=>{v>h&&(y(h>0?h:1),O(e=>({...e,page:h>0?h:1})))},[h,v,y]);const be=e=>{O(o=>({...o,...e})),$(!0),e.placementId&&z(e.placementId),e.hrPositionId&&N(e.hrPositionId),e.organizationId&&P(e.organizationId),e.name&&w(e.name),e.size&&ye(e.size)};l.useEffect(()=>{be({placementId:x,hrPositionId:C,organizationId:b,name:S,page:v,size:Y})},[fe]),l.useEffect(()=>{A().then(()=>$(!1))},[p,A]),l.useEffect(()=>{!q&&d&&_(d.length)},[d,q,_]);const Pe=()=>{z(x),N("*"),P("*"),w(void 0)},G={name:"",hrPositionId:"",placementId:"",organizationId:"",startWorkDate:void 0,phone:void 0,email:void 0,description:void 0,monthlySalary:"",dailySalary:"",percentageSalary:"",gender:void 0,citizenship:void 0,passportSeries:void 0,passportNumber:void 0,passportExtradition:void 0,passportDateIssue:void 0,inn:void 0,snils:void 0},[s,J]=l.useState(G),{register:n,handleSubmit:Ce,errors:i,setValue:Ne,reset:ze}=He(s),{trigger:De,isMutating:ke}=Ge(["create-employee"],async()=>Je({name:s.name,hrPositionId:s.hrPositionId,placementId:s.placementId,organizationId:s.organizationId,startWorkDate:s.startWorkDate,phone:s.phone,email:s.email,description:s.description,monthlySalary:s.monthlySalary,dailySalary:s.dailySalary,percentageSalary:s.percentageSalary,gender:s.gender,citizenship:s.citizenship,passportSeries:s.passportSeries,passportNumber:s.passportNumber,passportExtradition:s.passportExtradition,passportDateIssue:s.passportDateIssue,inn:s.inn,snils:s.snils},he)),r=(e,o)=>{const u=["monthlySalary","dailySalary","percentageSalary"].includes(e)?Number(o):o;J(m=>({...m,[e]:u})),Ne(e,o)},Ee=e=>{var g;const o=((g=e.target.files)==null?void 0:g[0])||null;if(ge(o),o){const u=new FileReader;u.onloadend=()=>{R(u.result)},u.readAsDataURL(o)}else R(null)},F=()=>{J(G),ze(),M(!W)},Ve=async()=>{try{if(await De())aa(["get-workers"]),F();else throw new Error("Invalid response from API")}catch(e){console.error("Error during form submission: ",e)}};return a.jsxs("div",{children:[a.jsxs(Ke,{count:H.length,hideDateTime:!0,address:x,setAddress:z,handleClear:Pe,hideSearch:!0,children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm text-text02",children:t("roles.job")}),a.jsx(ne,{className:"w-full sm:w-80 h-10",placeholder:t("warehouse.notSel"),options:[...T,B],value:C,onChange:e=>N(e),dropdownRender:e=>a.jsx("div",{style:{maxHeight:100,overflowY:"auto"},children:e})})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm text-text02",children:t("warehouse.organization")}),a.jsx(ne,{className:"w-full sm:w-80 h-10",placeholder:t("warehouse.notSel"),options:[...f,B],value:b,onChange:e=>P(e),dropdownRender:e=>a.jsx("div",{style:{maxHeight:100,overflowY:"auto"},children:e})})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm text-text02",children:t("hr.full")}),a.jsx(Qe,{className:"w-full sm:w-80 h-10",placeholder:t("hr.enter"),value:S,onChange:e=>w(e.target.value)})]})]}),a.jsxs("div",{className:"mt-5",children:[de&&a.jsx(ce,{title:t("routes.employees"),message:t("hr.to"),onClose:()=>ue(!1),showEmp:!0}),q||ve?a.jsx(Ue,{columnCount:re.length}):a.jsx("div",{className:"mt-8",children:a.jsx(Xe,{data:H,columns:re,navigableFields:[{key:"name",getPath:()=>"/hr/employees/profile"}],showPagination:!0})})]}),a.jsx(Ze,{onClose:F,children:a.jsxs("form",{className:"space-y-4",onSubmit:Ce(Ve),children:[a.jsx("div",{className:"font-semibold text-xl md:text-3xl mb-5 text-text01",children:t("routes.addE")}),pe&&a.jsx(ce,{title:t("hr.att"),message:t("hr.if"),message2:t("hr.ifThe"),onClose:()=>me(!1)}),a.jsxs("div",{className:"flex",children:[a.jsx("span",{className:"font-semibold text-sm text-text01",children:t("routine.fields")}),a.jsx("span",{className:"text-errorFill",children:"*"}),a.jsx("span",{className:"font-semibold text-sm text-text01",children:t("routine.are")})]}),a.jsx("div",{className:"font-semibold text-2xl text-text01",children:t("warehouse.basic")}),a.jsx(c,{title:`${t("hr.full")}*`,label:t("hr.enter"),type:"text",classname:"w-80",value:s.name,changeValue:e=>r("name",e.target.value),error:!!i.name,...n("name",{required:"Name is required"}),helperText:((K=i.name)==null?void 0:K.message)||""}),a.jsx(j,{title:`${t("roles.job")}*`,label:t("hr.selectPos"),options:T,classname:"w-64",...n("hrPositionId",{required:"hrPositionId is required",validate:e=>e!==""||"Pos ID is required"}),value:s.hrPositionId,onChange:e=>r("hrPositionId",e),error:!!i.hrPositionId,helperText:((Q=i.hrPositionId)==null?void 0:Q.message)||""}),a.jsx(j,{title:`${t("pos.city")} *`,label:V.length===0?t("warehouse.noVal"):t("warehouse.notSel"),options:V,classname:"w-64",...n("placementId",{required:"Placement Id is required",validate:e=>e!==""||"Organization ID is required"}),value:s.placementId,onChange:e=>r("placementId",e),error:!!i.placementId,helperText:(U=i.placementId)==null?void 0:U.message}),a.jsx(j,{title:`${t("warehouse.organization")} *`,label:f.length===0?t("warehouse.noVal"):t("warehouse.notSel"),options:f,classname:"w-64",...n("organizationId",{required:"Organization Id is required",validate:e=>e!==""||"Organization ID is required"}),value:s.organizationId,onChange:e=>r("organizationId",e),error:!!i.organizationId,helperText:(X=i.organizationId)==null?void 0:X.message}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm text-text02",children:t("hr.date")}),a.jsx(ie,{classname:"w-40",value:s.startWorkDate?le(s.startWorkDate):null,changeValue:e=>r("startWorkDate",e?e.format("YYYY-MM-DD"):""),...n("startWorkDate")})]}),a.jsx(c,{type:"",title:t("profile.telephone"),label:t("warehouse.enterPhone"),classname:"w-80",value:s.phone,changeValue:e=>r("phone",e.target.value),...n("phone",{pattern:{value:/^\+79\d{9}$/,message:"Phone number must start with +79 and be 11 digits long"}}),error:!!i.phone,helperText:((Z=i.phone)==null?void 0:Z.message)||""}),a.jsx(c,{type:"",title:"E-mail",label:t("marketing.enterEmail"),classname:"w-80",value:s.email,changeValue:e=>r("email",e.target.value),...n("email")}),a.jsx(ea,{title:t("warehouse.desc"),label:t("warehouse.about"),classname:"w-80",inputType:"secondary",value:s.description,changeValue:e=>r("description",e.target.value),...n("description")}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm text-text02",children:t("profile.photo")}),a.jsxs("div",{className:"flex space-x-2 items-center cursor-pointer",onClick:()=>{var e;return(e=document.getElementById("photo-upload"))==null?void 0:e.click()},children:[a.jsx("img",{src:xe||sa,alt:"Profile",className:"w-16 h-16 object-cover rounded-full border border-gray-300",loading:"lazy"}),a.jsx("div",{className:"text-primary02 font-semibold",children:t("hr.upload")})]}),a.jsx("input",{type:"file",id:"photo-upload",accept:"image/*",style:{display:"none"},onChange:Ee})]}),a.jsx("div",{className:"text-text01 font-semibold text-2xl",children:t("hr.salary")}),a.jsx(c,{title:`${t("hr.month")}*`,type:"number",classname:"w-44",showIcon:!0,IconComponent:a.jsx("div",{className:"text-text02 text-xl",children:"₽"}),value:s.monthlySalary,changeValue:e=>r("monthlySalary",e.target.value),error:!!i.monthlySalary,...n("monthlySalary",{required:"monthlySalary is required"}),helperText:((ee=i.monthlySalary)==null?void 0:ee.message)||""}),a.jsx(c,{title:`${t("hr.daily")}*`,type:"number",classname:"w-44",value:s.dailySalary,changeValue:e=>r("dailySalary",e.target.value),error:!!i.dailySalary,...n("dailySalary",{required:"dailySalary is required"}),helperText:((ae=i.dailySalary)==null?void 0:ae.message)||""}),a.jsx(c,{title:`${t("marketing.per")}*`,type:"number",classname:"w-44",value:s.percentageSalary,changeValue:e=>r("percentageSalary",e.target.value),error:!!i.percentageSalary,...n("percentageSalary",{required:"percentageSalary is required"}),helperText:((te=i.percentageSalary)==null?void 0:te.message)||""}),a.jsx("div",{className:"text-text01 font-semibold text-2xl",children:t("hr.add")}),a.jsx(j,{title:`${t("marketing.floor")}`,label:t("warehouse.notSel"),options:[{name:t("marketing.man"),value:"Man"},{name:t("marketing.woman"),value:"Woman"}],classname:"w-64",...n("gender"),value:s.gender,onChange:e=>r("gender",e)}),a.jsx(c,{type:"",title:t("hr.citi"),label:t("hr.enterCiti"),classname:"w-80",value:s.citizenship,changeValue:e=>r("citizenship",e.target.value),...n("citizenship")}),a.jsx(c,{title:t("hr.passportSeries"),classname:"w-80",inputType:"secondary",value:s.passportSeries,changeValue:e=>r("passportSeries",e.target.value),...n("passportSeries")}),a.jsx(c,{type:"number",title:t("hr.passportNumber"),classname:"w-80",inputType:"secondary",value:s.passportNumber,changeValue:e=>r("passportNumber",e.target.value),...n("passportNumber")}),a.jsx(c,{title:t("hr.passportExtradition"),classname:"w-80",inputType:"secondary",value:s.passportExtradition,changeValue:e=>r("passportExtradition",e.target.value),...n("passportExtradition")}),a.jsx(ie,{title:t("hr.passportDateIssue"),classname:"w-40",value:s.passportDateIssue?le(s.passportDateIssue):null,changeValue:e=>r("passportDateIssue",e?e.format("YYYY-MM-DD"):""),...n("passportDateIssue")}),a.jsx(c,{type:"",title:t("marketing.inn"),classname:"w-80",value:s.inn,changeValue:e=>r("inn",e.target.value),...n("inn")}),a.jsx(c,{type:"",title:t("hr.snils"),classname:"w-80",value:s.snils,changeValue:e=>r("snils",e.target.value),...n("snils")}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-4 mt-6",children:[a.jsx(oe,{title:t("organizations.cancel"),type:"outline",handleClick:()=>{M(!W),F()}}),a.jsx(oe,{title:t("routes.addE"),form:!0,isLoading:ke,handleClick:()=>{}})]})]})})]})};export{la as default};

import{d as he,b as ge,r as d,q as pe,v as I,b3 as ve,b4 as xe,b5 as we,y as Ie,z as K,b6 as ye,b7 as be,j as t,A as fe,aA as H,D as je,b8 as _,G as Ne,H as Ce,b9 as Ee,J as De,K as c,L as y,Q as ke,B as S,M as b,ba as ze}from"./index-C24s9YLx.js";import{g as Se}from"./index-Dx68t6LI.js";const Re=()=>{var F,A,P,B,$,G,U,W;const{t:a}=he(),m=a("warehouse.all"),{buttonOn:T,setButtonOn:f}=ge(),[r,O]=d.useState(!1),[p,J]=d.useState(0),[h,v]=d.useState(m),[R,Q]=d.useState(""),[u,L]=d.useState(null),X=pe(),{data:j,isLoading:Y}=I(u?["get-inventory",h,u]:null,()=>ve(u),{revalidateOnFocus:!1,revalidateOnReconnect:!1,keepPreviousData:!0}),{data:N}=I(["get-category"],()=>xe(),{revalidateOnFocus:!1,revalidateOnReconnect:!1,keepPreviousData:!0}),{data:C}=I(["get-supplier"],()=>we(),{revalidateOnFocus:!1,revalidateOnReconnect:!1,keepPreviousData:!0}),{data:E}=I(["get-organization"],()=>Se({placementId:X}),{revalidateOnFocus:!1,revalidateOnReconnect:!1,keepPreviousData:!0,onSuccess:e=>{e&&e.length>0&&L(e[0].id)}}),q=((P=(A=(F=j==null?void 0:j.map(e=>e.props))==null?void 0:F.filter(e=>h===m||e.categoryId===h))==null?void 0:A.filter(e=>e.name.toLowerCase().includes(R.toLowerCase())))==null?void 0:P.map(e=>e))||[],g=(N==null?void 0:N.map(e=>({name:e.props.name,value:e.props.id})))||[],Z={name:m,value:m};g.unshift(Z);const D=q.map(e=>{var n;return{id:e.id,sku:e.sku,name:e.name,categoryId:(n=g.find(w=>w.value===e.categoryId))==null?void 0:n.name}}),V=(C==null?void 0:C.map(e=>({name:e.props.name,value:e.props.id})))||[],k=(E==null?void 0:E.map(e=>({name:e.name,value:e.id})))||[],M={name:"",sku:"",organizationId:0,categoryId:0,supplierId:void 0,measurement:"",description:void 0,weight:void 0,length:void 0,height:void 0,width:void 0,purpose:void 0},[s,z]=d.useState(M),{register:o,handleSubmit:ee,errors:l,setValue:te,reset:ae}=Ie(s),{trigger:se,isMutating:ne}=K(["create-inventory"],async()=>ye({name:s.name,sku:s.sku,organizationId:s.organizationId,categoryId:s.categoryId,supplierId:s.supplierId,measurement:s.measurement,metaData:{description:s.description,weight:s.weight,height:s.height,width:s.width,length:s.length,purpose:s.purpose}})),{trigger:re,isMutating:oe}=K(["update-inventory"],async()=>be({nomenclatureId:p,name:s.name,categoryId:s.categoryId,supplierId:s.supplierId,measurement:s.measurement,metaData:{description:s.description,weight:s.weight,height:s.height,width:s.width,length:s.length,purpose:s.purpose}})),i=(e,n)=>{const ce=["organizationId","categoryId","supplierId","weight","height","length","width"].includes(e)?Number(n):n;z(me=>({...me,[e]:ce})),te(e,n)},ie=e=>{O(!0),f(!0);const n=q.find(w=>w.id===e);n&&z({name:n.name,sku:n.sku,organizationId:n.organizationId,categoryId:n.categoryId,measurement:n.measurement,supplierId:n.supplierId,description:n.metaData?n.metaData.description:void 0,width:n.metaData?n.metaData.width:void 0,length:n.metaData?n.metaData.length:void 0,height:n.metaData?n.metaData.height:void 0,purpose:n.metaData?n.metaData.purpose:void 0,weight:n.metaData?n.metaData.weight:void 0})},le=async()=>{try{await b(["delete-nomenclature",p],()=>ze(p),!1)&&(f(!T),b(["get-inventory",h,u]))}catch(e){console.error("Error deleting nomenclature:",e)}},x=()=>{z(M),O(!1),ae(),J(0),f(!T)},ue=async()=>{try{if(p){const e=await re();if(e)v(e.props.categoryId),b(["get-inventory",e.props.categoryId,u]),x();else throw new Error("Invalid update data.")}else{const e=await se();if(e)v(e.props.categoryId),b(["get-inventory",e.props.categoryId,u]),x();else throw new Error("Invalid response from API")}}catch(e){console.error("Error during form submission: ",e)}},de=()=>{v(m)};return t.jsxs(t.Fragment,{children:[t.jsxs(fe,{count:D.length,hideDateTime:!0,handleClear:de,hideCity:!0,search:R,setSearch:Q,children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-text02",children:a("warehouse.organization")}),t.jsx(H,{className:"w-full sm:w-80 h-10",options:k.map(e=>({label:e.name,value:e.value})),value:u,onChange:e=>L(e)})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-text02",children:a("warehouse.category")}),t.jsx(H,{className:"w-full sm:w-80 h-10",options:g.map(e=>({label:e.name,value:e.value})),value:h,onChange:e=>v(e)})]})]}),Y?t.jsx(je,{columnCount:_.length}):D.length>0?t.jsx("div",{className:"mt-8",children:t.jsx(Ne,{data:D,columns:_,onEdit:ie})}):t.jsx("div",{className:"flex flex-col justify-center items-center",children:t.jsx(Ce,{title:a("warehouse.nomenclature"),description:"",children:t.jsx("img",{src:Ee,className:"mx-auto",loading:"lazy",alt:"Inventory"})})}),t.jsx(De,{onClose:x,children:t.jsxs("form",{className:"space-y-6",onSubmit:ee(ue),children:[t.jsx("div",{className:"font-semibold text-xl md:text-3xl mb-5 text-text01",children:a(r?"warehouse.edit":"warehouse.add")}),t.jsx("span",{className:"font-semibold text-sm text-text01",children:a("warehouse.fields")}),t.jsx("div",{className:"font-semibold text-2xl mb-5 text-text01",children:a("warehouse.basic")}),t.jsx(c,{title:a("profile.name"),label:a("warehouse.enter"),type:"text",classname:"w-80",value:s.name,changeValue:e=>i("name",e.target.value),error:!!l.name,...o("name",{required:!r&&"Name is required"}),helperText:((B=l.name)==null?void 0:B.message)||""}),t.jsx(y,{title:`${a("warehouse.category")} *`,label:g.length===0?a("warehouse.noVal"):a("warehouse.notSel"),options:g,classname:"w-64",...o("categoryId",{required:!r&&"Category Id is required",validate:e=>e!==0||r||"Category ID is required"}),value:s.categoryId,onChange:e=>i("categoryId",e),error:!!l.categoryId,helperText:($=l.categoryId)==null?void 0:$.message}),t.jsx(y,{title:`${a("routes.suppliers")}`,label:V.length===0?a("warehouse.noVal"):a("warehouse.notSel"),options:V,classname:"w-64",...o("supplierId"),value:s.supplierId,onChange:e=>i("supplierId",e)}),t.jsx(y,{title:`${a("warehouse.organization")} *`,label:k.length===0?a("warehouse.noVal"):a("warehouse.notSel"),options:k,classname:"w-64",...o("organizationId",{required:!r&&"Organization Id is required",validate:e=>e!==0||r||"Organization ID is required"}),value:s.organizationId,onChange:e=>i("organizationId",e),error:!!l.organizationId,helperText:(G=l.organizationId)==null?void 0:G.message,isDisabled:r}),t.jsx(y,{title:`${a("warehouse.unit")} *`,label:a("warehouse.notSel"),options:[{name:a("tables.PIECE"),value:"PIECE"},{name:a("tables.KILOGRAM"),value:"KILOGRAM"},{name:a("tables.LITER"),value:"LITER"},{name:a("tables.METER"),value:"METER"}],classname:"w-64",...o("measurement",{required:!r&&"Measurement is required"}),value:s.measurement,onChange:e=>i("measurement",e),error:!!l.measurement,helperText:(U=l.measurement)==null?void 0:U.message}),t.jsx(c,{title:`${a("warehouse.article")} *`,label:r?"":a("warehouse.enterItem"),type:"text",classname:"w-80",value:s.sku,changeValue:e=>i("sku",e.target.value),error:!!l.sku,...o("sku",{required:!r&&"sku is required"}),helperText:((W=l.sku)==null?void 0:W.message)||"",disabled:r}),t.jsx(ke,{title:a("warehouse.desc"),label:a("warehouse.about"),classname:"w-80",inputType:"secondary",value:s.description,changeValue:e=>i("description",e.target.value),...o("description")}),t.jsx("div",{className:"font-semibold text-2xl mb-5 text-text01",children:a("warehouse.product")}),t.jsx(c,{title:a("warehouse.weight"),label:a("warehouse.enterWgt"),type:"number",classname:"w-80",value:s.weight,changeValue:e=>i("weight",e.target.value),...o("weight")}),t.jsx(c,{title:a("warehouse.sizeW"),type:"number",classname:"w-20",value:s.width,changeValue:e=>i("width",e.target.value),...o("width")}),t.jsx(c,{title:a("warehouse.sizeG"),type:"number",classname:"w-20",value:s.length,changeValue:e=>i("length",e.target.value),...o("length")}),t.jsx(c,{title:a("warehouse.sizeB"),type:"number",classname:"w-20",value:s.height,changeValue:e=>i("height",e.target.value),...o("height")}),t.jsx("div",{className:"font-semibold text-2xl mb-5 text-text01",children:a("warehouse.purpose")}),t.jsxs("div",{className:"flex",children:[t.jsx("div",{className:"flex-1 flex flex-col",children:t.jsxs("div",{className:"flex",children:[t.jsx("input",{type:"radio",value:"SALE",checked:s.purpose==="SALE",...o("purpose"),onChange:e=>{i("purpose",e.target.value)}}),t.jsx("div",{className:"text-text02 ml-2",children:a("warehouse.sale")})]})}),t.jsx("div",{className:"flex-1 flex flex-col",children:t.jsxs("div",{className:"flex",children:[t.jsx("input",{type:"radio",value:"INTERNAL_USE",checked:s.purpose==="INTERNAL_USE",...o("purpose"),onChange:e=>{i("purpose",e.target.value)}}),t.jsx("div",{className:"text-text02 ml-2",children:a("warehouse.write")})]})})]}),t.jsxs("div",{className:"flex space-x-4",children:[t.jsx(S,{title:a("organizations.cancel"),type:"outline",handleClick:()=>{x()}}),r&&t.jsx(S,{title:a("warehouse.deletePos"),handleClick:le,classname:"bg-red-600 hover:bg-red-300"}),t.jsx(S,{title:a("organizations.save"),form:!0,isLoading:r?oe:ne,handleClick:()=>{}})]})]})})]})};export{Re as default};

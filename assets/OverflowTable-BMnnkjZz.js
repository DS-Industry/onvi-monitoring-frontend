import{r as L,W as ne,$ as ie,X as le,b$ as de,d as oe,bj as ce,f as xe,bp as be,e as ue,bb as pe,j as s,B as ge,n as h,c0 as me,c1 as Ae,F as I,c2 as he,p as ye,aB as je,c3 as fe,m as ke}from"./index-C24s9YLx.js";const P="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAADFSURBVHgBrdNbC4IwGAbgzxFLOhi2goT6/7+pLrrt5JLsroLyW25sC2wH3xunzIfvVZa8m4Bn6voOpzOHeT4DxnLxbACeQeRwvIh1yStxRcwbejxfxr3EnCGcBLNoq/AWwFyrmxuk17ExQghs1sV/yEbkWmKT8QjSdAhJ11/TEWZVKlZLyLKp2ktcEZwgkS81dSilxn7iiuAkpfZNsE4nFIL8QKGIAcUgCopFBNQHIqA+EFUNE4Ng1BHZ7vZfOQAxJopBMB/g66Ckoz1iugAAAABJRU5ErkJggg==",Ne="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAADLSURBVHgB7ZUxDoIwFIYfxvOYeBh2TuEKHkJnjZsOTs66aOKm7hrjBTxC6XuhBGiBlraw8CWEJqX/1768hoBxwCMT8Mwo6Ffw+H/9CbafC8xPC1i+Du4FGB7d1jSWep5ZsnmfGexCeuLnXpq3ErSFWwl0wjsLdMOVgui6ogAX4ZLg+Lvni1US03BJgOBClaRLODKttm0yC+mNF0b0NiLGMZ8X3+gQ0DEUJFxQvZWm4UTT8YrlMilLY4lKpyjs1njnGbUlcsX4wxlekAImmOr4N3+aOAAAAABJRU5ErkJggg==",Ce=({tableData:U,columns:x,isUpdate:S,isUpdateLeft:T,isStatus:v,isDisplayEdit:V,nameUrl:O,title:F,nameUrlTitle:$,urlTitleId:w,onUpdate:b,handleChange:W,isCheck:B,showTotal:G=!1,renderCell:R,showPagination:z,showTotalClean:Q=!1})=>{const[y,X]=L.useState(x.map(e=>e.key)),i=ne(),j=ie(),Z=le(),Y=de(),{t:a}=oe(),K=Intl.DateTimeFormat().resolvedOptions().timeZone,f=x.filter(e=>y.includes(e.key)),o=Math.ceil(Y/Z),l=U,{filterOn:k,setFilterOn:N}=ce(),D=xe(),H=be(),E=ue(),[J,u]=L.useState(!1),q=e=>{X(t=>t.includes(e)?t.filter(r=>r!==e):[...t,e])},p=(e,t="number")=>e==null||isNaN(e)?"-":new Intl.NumberFormat("ru-RU",{minimumFractionDigits:t==="double"?2:0,maximumFractionDigits:t==="double"?2:0,useGrouping:!0}).format(e),_=()=>{for(const e of ke){if(E.pathname===e.path)return e;if(e.subMenu&&e.subNav)for(const t of e.subNav){if(E.pathname===t.path)return t;if(t.subMenu&&t.subNav){for(const r of t.subNav)if(E.pathname===r.path)return r}}}},g=pe(),n=_(),ee=()=>{const e=[];if(o<=5)for(let t=1;t<=o;t++)e.push(t);else{e.push(1),i>3&&e.push("...");const t=Math.max(2,i-1),r=Math.min(o-1,i+1);for(let d=t;d<=r;d++)e.push(d);i<o-2&&e.push("..."),e.push(o)}return e},te=e=>{typeof e=="number"&&(N(!k),j(e))},se=e=>{if(!e)return"";const[t,r]=e.split("-").map(c=>c.trim()),d=c=>{const A=c.split("GMT")[0].trim();return new Date(A).toLocaleDateString("ru-RU")};return`${d(t)} - ${d(r)}`},m=e=>e.includes("administration")?[{action:"manage",subject:"Organization"},{action:"update",subject:"Organization"}]:e.includes("station")?[{action:"manage",subject:"Pos"},{action:"update",subject:"Pos"}]:e.includes("equipment")?[{action:"manage",subject:"Incident"},{action:"update",subject:"Incident"},{action:"manage",subject:"TechTask"},{action:"update",subject:"TechTask"}]:e.includes("warehouse")?[{action:"manage",subject:"Warehouse"},{action:"update",subject:"Warehouse"}]:e.includes("finance")?[{action:"manage",subject:"CashCollection"},{action:"update",subject:"CashCollection"}]:e.includes("analysis")?[{action:"manage",subject:"ShiftReport"},{action:"update",subject:"ShiftReport"}]:[],ae=[{name:a("routes.COMMISSIONING"),value:"COMMISSIONING"},{name:a("routes.WRITEOFF"),value:"WRITEOFF"},{name:a("routes.MOVING"),value:"MOVING"},{name:a("routes.INVENTORY"),value:"INVENTORY"},{name:a("routes.RECEIPT"),value:"RECEIPT"}];return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-full overflow-auto",children:s.jsxs("div",{className:"max-w-full overflow-x-auto",children:[F&&s.jsx("span",{className:"cursor-pointer  flex justify-start sm:justify-end",onClick:()=>D(`${$}`,{state:{ownerId:w}}),children:s.jsx(ge,{title:F,type:"outline",classname:"mb-2",iconArrowDiognal:!0})}),s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[B&&s.jsx("th",{className:"border border-background02 bg-background06 w-11"}),v&&s.jsx("th",{className:"border border-background02 bg-background06 w-11"}),s.jsx(h,{requiredPermissions:m((n==null?void 0:n.path)||""),userPermissions:g,children:e=>e&&T&&s.jsx("th",{className:"border border-background02 bg-background06 w-11 min-w-11"})}),x.map(e=>y.includes(e.key)&&s.jsx("th",{className:"border-b border-x-2 border-background02 bg-background06 px-2.5 py-5 text-start text-sm font-semibold text-text01 tracking-wider",children:e.label},e.key)),s.jsx(h,{requiredPermissions:m((n==null?void 0:n.path)||""),userPermissions:g,children:e=>e&&S&&s.jsx("th",{className:"border border-background02 bg-background06 w-11 min-w-11"})})]})}),s.jsxs("tbody",{children:[l==null?void 0:l.map(e=>s.jsxs("tr",{children:[B&&s.jsx("td",{className:"border-b border-[#E4E5E7] bg-background02 py-2 px-2.5 text-start",children:e.status==="FINISHED"&&s.jsx("img",{src:Ne,loading:"lazy",alt:"CHECK"})}),v&&s.jsx("td",{className:"border-b border-[#E4E5E7] bg-background02 py-2 px-2.5 text-start",children:e.status==="SENT"?s.jsx("img",{src:me,loading:"lazy",alt:"SENT"}):s.jsx("img",{src:Ae,loading:"lazy",alt:"SAVED"})}),s.jsx(h,{requiredPermissions:m((n==null?void 0:n.path)||""),userPermissions:g,children:t=>t&&T&&s.jsx("td",{className:"border-b border-[#E4E5E7] bg-background02 py-2 px-2.5 text-start",children:s.jsx("button",{className:"flex items-center",onClick:()=>b&&b(e.id),children:s.jsx("img",{src:P,loading:"lazy",alt:"UPDATE"})})})}),f.map(t=>{var r,d,c,A,C;return s.jsx("td",{className:"border-b border-x-4 border-b-[#E4E5E7] border-x-background02 bg-background02 py-2 px-2.5 text-start whitespace-nowrap text-sm text-text01 overflow-hidden overflow-x-visible",children:(t.key==="name"||t.key==="posName"&&!e.name)&&O?s.jsx("span",{className:"cursor-pointer",onClick:()=>{var M;D(`${O}`,{state:{ownerId:e.id,name:e.name,status:e.status,type:e.type,workDate:e.startWorkDate,endDate:e.endSpecifiedDate}}),H(((M=ae.find(re=>re.name===e.type))==null?void 0:M.value)||"")},children:s.jsxs("div",{className:"whitespace-nowrap flex items-center space-x-2 text-ellipsis overflow-hidden text-primary02 hover:text-primary02_Hover hover:underline",children:[e[t.key],s.jsx(I,{icon:"arrow-up-right",className:"w-4 h-4"})]})}):t.type==="number"||t.type==="double"?e[t.key]?s.jsx("div",{className:`${e[t.key]<0||t.key==="shortageDeviceType"&&e[t.key]>0?"text-errorFill":""}`,children:p(e[t.key],t.type)}):"-":t.type==="percent"?e[t.key]?s.jsx("div",{className:`${e[t.key]<0?"text-errorFill":""}`,children:`${p(e[t.key])}%`}):"-":t.render?t.render(e,W):R?R(t,e):t.key.toLocaleLowerCase().includes("status")?s.jsxs("div",{className:`flex items-center justify-center gap-2 whitespace-nowrap text-ellipsis overflow-hidden
                             ${e[t.key]===a("tables.ACTIVE")||e[t.key]===a("tables.SENT")||e[t.key]===a("analysis.DONE")?"text-[#00A355]":e[t.key]===a("tables.OVERDUE")||e[t.key]===a("analysis.ERROR")?"text-errorFill":e[t.key]===a("tables.SAVED")||e[t.key]===a("analysis.PROGRESS")?"text-[#FF9066]":"text-text01"} 
                             ${e[t.key]===a("tables.SENT")||e[t.key]===a("tables.ACTIVE")?"rounded-2xl px-2 py-1 bg-[#D1FFEA]":""}
                             ${e[t.key]===a("tables.SAVED")?"rounded-2xl px-2 py-1 bg-[#FFE6C7]":""}`,children:[e[t.key]===a("tables.SENT")||e[t.key]===a("tables.ACTIVE")&&s.jsx("span",{className:"w-2 h-2 bg-[#00A355] rounded-full"}),e[t.key]===a("tables.SAVED")&&s.jsx("span",{className:"w-2 h-2 bg-[#FF9066] rounded-full"}),e[t.key]]}):s.jsx("div",{className:"whitespace-nowrap text-ellipsis overflow-hidden",children:t.type==="date"?e[t.key]?he.createDateTimeWithoutComma(e[t.key],K):"-":t.type==="period"?e[t.key]?se(e[t.key]):"-":typeof e[t.key]=="object"?`${((r=e[t.key])==null?void 0:r.name)||""} ${((d=e[t.key])==null?void 0:d.city)||""} ${((c=e[t.key])==null?void 0:c.location)||""} ${((A=e[t.key])==null?void 0:A.lat)||""} ${((C=e[t.key])==null?void 0:C.lon)||""}`:e[t.key]})},t.key)}),s.jsx(h,{requiredPermissions:m((n==null?void 0:n.path)||""),userPermissions:g,children:t=>t&&S&&s.jsx("td",{className:"border-b border-[#E4E5E7] bg-background02 py-2 px-2.5 text-start",children:s.jsx("button",{className:"flex items-center",onClick:()=>b&&b(e.id),children:s.jsx("img",{src:P,loading:"lazy",alt:"UPDATE"})})})})]},e.id)),(l==null?void 0:l.length)>0&&G&&s.jsxs("tr",{className:"h-11 px-3 bg-background05 text-sm font-semibold text-text01",children:[s.jsx("td",{className:"p-2 text-left",colSpan:3,children:a("finance.total")}),f.slice(3).map(e=>s.jsx("td",{className:"p-2 text-right",children:e.type==="number"?p(l.reduce((t,r)=>t+(Number(r[e.key])||0),0)):"-"},e.key))]}),(l==null?void 0:l.length)>0&&Q&&s.jsxs("tr",{className:"h-11 px-3 bg-background05 text-sm font-semibold text-text01",children:[s.jsx("td",{className:"p-2 text-left",colSpan:2,children:a("finance.total")}),f.slice(2).map(e=>s.jsx("td",{className:"p-2 text-right",children:e.type==="number"?p(l.reduce((t,r)=>t+(Number(r[e.key])||0),0)):""},e.key))]})]})]})]})}),z&&s.jsxs("div",{className:"mt-4 flex gap-2",children:[s.jsx("button",{onClick:()=>{const e=Math.max(1,i-1);N(!k),j(e)},disabled:i===1,className:`px-2 py-1 ${i===1?"text-gray-400 cursor-not-allowed":"text-text01"}`,children:s.jsx(I,{icon:"chevron-left"})}),ee().map((e,t)=>e==="..."?s.jsx("span",{className:"px-2 py-1 text-gray-400",children:"..."},t):s.jsx("button",{onClick:()=>te(e),className:`px-4 py-2 font-semibold ${i===e?"bg-white text-primary02 rounded-lg border border-primary02":"text-text01"}`,children:e},t)),s.jsx("button",{onClick:()=>{N(!k),j(Math.min(o,i+1))},disabled:i===o,className:`px-2 py-1 ${i===o?"text-gray-400 cursor-not-allowed":"text-text01"}`,children:s.jsx(I,{icon:"chevron-right"})})]}),V&&s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:()=>u(!0),className:"text-primary02 text-sm font-semibold flex items-center gap-2 mt-5 py-2",children:["Настройки таблицы ",s.jsx(ye,{})]}),s.jsx(je,{isOpen:J,onClose:()=>u(!1),handleClick:()=>u(!1),classname:"max-h-[600px] overflow-auto",children:s.jsx(fe,{columns:x,selectedColumns:y,onColumnToggle:q,onIsModalOpen:()=>u(!1),storageKey:""})})]})]})};export{Ce as O};
